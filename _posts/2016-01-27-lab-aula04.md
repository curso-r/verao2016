---
title: "Aula 04 - Laboratório"
author: "Curso R"
date: 2016-01-22
output: html_document
tags: lab
layout: post
comments: true
category: lab
---

Os exercícios desse laboratório ajudarão o aluno a construir seus primeiros gráficos usando o `ggplot2`, começando de gráficos bem simples até gráficos um pouco mais complexos. Nestes exercícios você utilizará a base de dados `diamonds` , do pacote `ggplot2`.


{% highlight r %}
library(ggplot2)
{% endhighlight %}



{% highlight text %}
## Carregando pacotes exigidos: methods
{% endhighlight %}



{% highlight r %}
library(dplyr)
{% endhighlight %}



{% highlight text %}
## 
## Attaching package: 'dplyr'
## 
## The following objects are masked from 'package:stats':
## 
##     filter, lag
## 
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
{% endhighlight %}



{% highlight r %}
library(tidyr)
library(lubridate)
{% endhighlight %}



{% highlight text %}
## Warning: package 'lubridate' was built under R version 3.2.3
{% endhighlight %}

Enfim, os dados:


{% highlight r %}
head(diamonds, 10)
{% endhighlight %}



{% highlight text %}
##    carat       cut color clarity depth table price    x    y    z
## 1   0.23     Ideal     E     SI2  61.5    55   326 3.95 3.98 2.43
## 2   0.21   Premium     E     SI1  59.8    61   326 3.89 3.84 2.31
## 3   0.23      Good     E     VS1  56.9    65   327 4.05 4.07 2.31
## 4   0.29   Premium     I     VS2  62.4    58   334 4.20 4.23 2.63
## 5   0.31      Good     J     SI2  63.3    58   335 4.34 4.35 2.75
## 6   0.24 Very Good     J    VVS2  62.8    57   336 3.94 3.96 2.48
## 7   0.24 Very Good     I    VVS1  62.3    57   336 3.95 3.98 2.47
## 8   0.26 Very Good     H     SI1  61.9    55   337 4.07 4.11 2.53
## 9   0.22      Fair     E     VS2  65.1    61   337 3.87 3.78 2.49
## 10  0.23 Very Good     H     VS1  59.4    61   338 4.00 4.05 2.39
{% endhighlight %}

Para ver uma descrição das variáveis deste banco de dados, utilize a função `help()`:


{% highlight r %}
help(diamonds)
{% endhighlight %}

### geom_point

**1.** Quais são os aspectos estéticos (*aesthetics*) exigidos (obrigatórios) da função `geom_point()`?

Dica: utilizar a função `help()`.

**2.** Faça um gráfico de dispersão do preço (*price*) pela variável quilates (*carat*). Utilize as funções `xlab()` e `ylab()` para trocar os *labels* dos eixos x e y, respectivamente.

**3.** Utilize a `facets` para fazer gráficos de dispersão do preço pela variável quilate (o mesmo gráfico do exercício 1) para cada nível da variável claridade (*clarity*).

### geom_histogram

**4.** Quais são os aspectos estéticos (*aesthetics*) exigidos (obrigatórios) da função `geom_histogram()`?

**5.** Faça um histograma da variável preço. 

**6.** Utilize a função `geom_density()` para **adicionar** ao gráfico anterior uma estimativa suavizada da densidade. 

### geom_boxplot

**7.** Quais são os aspectos estéticos (*aesthetics*) exigidos (obrigatórios) da função `geom_boxplot()`?

**8.** Faça boxplots da variável preço pela variável corte (*cut*).

### geom_bar

**9.** Quais são os aspectos estéticos (*aesthetics*) exigidos (obrigatórios) da função `geom_bar()`?

**10.** Faça um gráfico de barras do número de diamantes em cada categoria da variável cor (*color*).

## Outra base de dados

A partir de agora utilizaremos a base de dados `economics` para fazer os gráficos. Alguns exercícios exigirão manipulações na base de dados, que devem ser feitas usando `dplyr` e `tidyr`, antes da construção dos gráficos.

**11.** Faça um gráfico de dispersão do número de desempregados (eixo x) pelo tempo médio de desemprego (eixo y). Não se esqueça de alterar o `label` dos eixos.

**12.** Faça o mesmo gráfico do exercício anterior, no entanto, os pontos devem ter cores diferentes para cada ano, seguindo uma escala contínua.

Dica: utilize a função `year` do pacote `lubridate` para saber o ano de cada data.

**13.** Faça um gráfico de linha do número de desempregados (eixo y) e a data (eixo x).

**14.** Repita o gráfico anterior, no entanto desta vez a periodicidade deve ser anual e o valor apresentado no eixo y deve ser o número médio de desempregados.

Dica: Agregue a base usando o `dplyr` antes.

**15** Tente reproduzir o seguinte gráfico:

- a linha é a mediana de desempregados por ano
- o limite inferior da banda é o quantil de 1% do número de desempregados
- o limtie superior da banda é o quantil de 99% do número de desempregados

![plot of chunk unnamed-chunk-4](http://curso-r.github.io/verao2016/images/2016-01-27-lab-aula04/unnamed-chunk-4-1.png) 

Dica: utilize a função `geom_ribbon` para fazer a banda envolta da linha.

**16.** Afim de comparar a evolução no tempo dos índices `pce`, `psaver` e taxa de desemprego (`unemploy`/`pop`), tente refazer o seguinte gráfico.

![plot of chunk unnamed-chunk-5](http://curso-r.github.io/verao2016/images/2016-01-27-lab-aula04/unnamed-chunk-5-1.png) 

Você precisará deixar os seus dados no formato long usando a função `gather` do `tidyr`.




