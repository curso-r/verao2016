<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Curso-R 2016</title>
    <description>Material das aulas do curso de R</description>
    <link>http://curso-r.github.io/versao2016//</link>
    <atom:link href="http://curso-r.github.io/versao2016//feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 13 Jan 2016 21:38:23 +0100</pubDate>
    <lastBuildDate>Wed, 13 Jan 2016 21:38:23 +0100</lastBuildDate>
    <generator>Jekyll v2.5.3</generator>
    
      <item>
        <title>Aula 12 - Laboratório IV</title>
        <description>&lt;p&gt;O objetivo deste laboratório é criar um aplicativo no Shiny para ajuste de um 
modelo de regressão linear ao banco de dados &lt;code&gt;diamonds&lt;/code&gt; do R.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Carregando pacotes exigidos: methods&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;diamonds&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##   carat       cut color clarity depth table price    x    y    z
## 1  0.23     Ideal     E     SI2  61.5    55   326 3.95 3.98 2.43
## 2  0.21   Premium     E     SI1  59.8    61   326 3.89 3.84 2.31
## 3  0.23      Good     E     VS1  56.9    65   327 4.05 4.07 2.31
## 4  0.29   Premium     I     VS2  62.4    58   334 4.20 4.23 2.63
## 5  0.31      Good     J     SI2  63.3    58   335 4.34 4.35 2.75
## 6  0.24 Very Good     J    VVS2  62.8    57   336 3.94 3.96 2.48&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Digite &lt;code&gt;?diamonds&lt;/code&gt; para entender o que cada variável significa.&lt;/p&gt;

&lt;p&gt;O aplicativo deverá conter:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Um seletor da variável resposta que será considerada pelo modelo.&lt;/li&gt;
  &lt;li&gt;Um seletor de uma covariável para o modelo&lt;/li&gt;
  &lt;li&gt;Um gráfico da variável resposta (eixo y) pela variável utilizadas no modelo,
incluindo a reta ajustada.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Utilize o &lt;a href=&quot;https://github.com/curso-r/lab04&quot;&gt;repositório do lab04 no github&lt;/a&gt; como template para o seu trabalho.&lt;/p&gt;

</description>
        <pubDate>Fri, 13 Feb 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula12/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula12/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 11 - Pacotes e tópicos extras</title>
        <description>&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/slides/aula_11_apresentacao.html&quot; target=&quot;_blank&quot;&gt;Slides dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;criao-de-pacotes&quot;&gt;Criação de pacotes&lt;/h1&gt;

&lt;h2 id=&quot;criao-de-pacotes-1&quot;&gt;Criação de pacotes&lt;/h2&gt;

&lt;p&gt;Baseado no livro &lt;a href=&quot;http://r-pkgs.had.co.nz/description.html&quot;&gt;r-pkgs&lt;/a&gt; do Hadley&lt;/p&gt;

&lt;h2 id=&quot;vantagens&quot;&gt;Vantagens&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Economia de tempo para tarefas futuras&lt;/li&gt;
  &lt;li&gt;Forma de organização pré-estabelecida&lt;/li&gt;
  &lt;li&gt;Contribuir e aproveitar contribuições da comunidade&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;filosofia&quot;&gt;Filosofia&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Tudo que pode ser automatizado, deve ser automatizado&lt;/li&gt;
  &lt;li&gt;Utilização do pacote &lt;code&gt;devtools&lt;/code&gt; como base para criação de pacotes&lt;/li&gt;
  &lt;li&gt;Trabalhar menos com os detalhes (estrutura, etc.) e mais com funcionalidades (funções úteis, etc).&lt;/li&gt;
  &lt;li&gt;Se for necessário trabalhar com coisas mais complexas, ler &lt;a href=&quot;cran.r-project.org/doc/manuals/R-exts.html#Creating-R-packages&quot;&gt;Writing R extensions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;pr-requisitos&quot;&gt;Pré-requisitos&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Pacotes &lt;code&gt;devtools&lt;/code&gt;, &lt;code&gt;roxygen2&lt;/code&gt;, &lt;code&gt;testthat&lt;/code&gt;, &lt;code&gt;knitr&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;R&lt;/strong&gt; e &lt;strong&gt;RStudio&lt;/strong&gt; atualizados (recomenda-se preview version do RStudio)&lt;/li&gt;
  &lt;li&gt;Instalar versão &lt;code&gt;dev&lt;/code&gt; do &lt;code&gt;devtools&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;devtools&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;install_github&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;hadley/devtools&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;pr-requisitos-1&quot;&gt;Pré-requisitos&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;No Windows, instalar o &lt;a href=&quot;cran.r-project.org/bin/windows/Rtools&quot;&gt;Rtools&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;No Mac, instalar o &lt;a href=&quot;developer.apple.com/downloads&quot;&gt;XCode&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;No linux, instalar o pacote de desenvolvimento &lt;code&gt;r-base-dev&lt;/code&gt;. No Ubuntu, basta digitar&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;sudo apt&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;get install r&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;base&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;dev&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ul&gt;
  &lt;li&gt;Verifique se está tudo certo digitando &lt;code&gt;devtools::has_devel()&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;exemplo&quot;&gt;Exemplo&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Crie um projeto pelo RStudio e selecione “R project”.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;estrutura&quot;&gt;Estrutura&lt;/h2&gt;

&lt;p&gt;Essa é a estrutura mínima para criar um pacote.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Tudo dentro de uma pasta&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;DESCRIPTION&lt;/code&gt;: Metadados do pacote.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;NAMESPACE&lt;/code&gt;: Importante para jogar pacote no CRAN.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;R/&lt;/code&gt;: Pasta onde fica o código R&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;man/&lt;/code&gt;: Pasta onde fica a documentação&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;xxx.Rproj&lt;/code&gt;: Seu projeto (não é necessário).&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;tipos--estados-dos-pacotes&quot;&gt;Tipos / estados dos pacotes&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Source (código fonte)&lt;/li&gt;
  &lt;li&gt;Bundled (&lt;code&gt;.tar.gz&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;Binary (binário, compactado)&lt;/li&gt;
  &lt;li&gt;Installed (binário, descompactado numa pasta)&lt;/li&gt;
  &lt;li&gt;In memory (depois de dar &lt;code&gt;library()&lt;/code&gt; ou &lt;code&gt;require()&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;cdigo-r&quot;&gt;Código R&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Todo o código em &lt;code&gt;R&lt;/code&gt; fica aqui&lt;/li&gt;
  &lt;li&gt;Tudo é baseado em funções. Crie objetos, principalmente funções, e não use coisas como &lt;code&gt;View()&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Melhor &lt;em&gt;workflow&lt;/em&gt;: Editar R -&amp;gt; Ctrl+Shift+L -&amp;gt; Teste no console -&amp;gt; Editar R -&amp;gt; …&lt;/li&gt;
  &lt;li&gt;Organizando funções: dividir arquivos por temas, e manter um padrão de títulos e conteúdos&lt;/li&gt;
  &lt;li&gt;Não use &lt;code&gt;library()&lt;/code&gt;, &lt;code&gt;require()&lt;/code&gt; nem &lt;code&gt;source()&lt;/code&gt;, &lt;code&gt;setwd()&lt;/code&gt;, etc. Ao invés disso, coloque dependências na documentação.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;documentao&quot;&gt;Documentação&lt;/h2&gt;

&lt;h3 id=&quot;arquivo-description&quot;&gt;Arquivo &lt;code&gt;DESCRIPTION&lt;/code&gt;&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Definir &lt;code&gt;Imports&lt;/code&gt;, &lt;code&gt;Suggests&lt;/code&gt;, e usar o &lt;code&gt;::&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;devtools::use_package()&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Versões &lt;code&gt;(&amp;gt;= 0.3)&lt;/code&gt;, &lt;code&gt;devtools::numeric_version()&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;Depends&lt;/code&gt; (versões de R).&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;Authors@R&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://choosealicense.com&quot;&gt;Licensas&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;documentao-1&quot;&gt;Documentação&lt;/h2&gt;

&lt;h3 id=&quot;documentao-dos-objetos&quot;&gt;Documentação dos objetos&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ensina o usuário a usar o pacote&lt;/li&gt;
  &lt;li&gt;Facilmente construído, colocando headers nas funções do R e usando &lt;code&gt;devtools::document()&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Começar com &lt;code&gt;#&#39;&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;workflow&lt;/em&gt;: Adicionar documentação em &lt;code&gt;roxygen&lt;/code&gt; -&amp;gt; chamar &lt;code&gt;devtools::document()&lt;/code&gt; -&amp;gt; visualizar documentação com &lt;code&gt;?&lt;/code&gt; -&amp;gt; Adicionar documentação em &lt;code&gt;roxygen&lt;/code&gt; -&amp;gt; …&lt;/li&gt;
  &lt;li&gt;Tags com &lt;code&gt;@tag&lt;/code&gt; (ex: &lt;code&gt;@param&lt;/code&gt;).&lt;/li&gt;
  &lt;li&gt;Primeira sentença é o título. Segundo parágrafo é uma descrição. Os outos parágrafos vão para &lt;em&gt;Details&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;vignettes&quot;&gt;Vignettes&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Útil para dar uma explicação geral de um pacote&lt;/li&gt;
  &lt;li&gt;Facilmente construído usando RMarkdown&lt;/li&gt;
  &lt;li&gt;Geralmente usado para pacotes mais complexos&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;testes&quot;&gt;Testes&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Pacote &lt;code&gt;testthat&lt;/code&gt;, do Hadley.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;devtools::use_testthat()&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Defina o que você quer testar (função e parâmetros), e o que você espera de resultado&lt;/li&gt;
  &lt;li&gt;&lt;em&gt;workflow&lt;/em&gt;: mude códigos -&amp;gt; &lt;code&gt;devtools::test()&lt;/code&gt; -&amp;gt; repita.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;stringr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
context&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;String Length&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
test_that&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;str_length is a number of characters&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  expect_equal&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;str_length&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  expect_equal&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;str_length&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;ab&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  expect_equal&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;str_length&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;abc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;namespace&quot;&gt;Namespace&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Só é necessário se preocupar com isso se você quiser colocar seu pacote no CRAN.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;imports&lt;/code&gt; e &lt;code&gt;exports&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Search path, load e attach&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;requireNamespace()&lt;/code&gt; dá load e não attach.&lt;/li&gt;
  &lt;li&gt;Geralmente também é criado usando &lt;code&gt;devtools::document()&lt;/code&gt; e &lt;code&gt;roxygen2&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Use &lt;code&gt;@export&lt;/code&gt; para fazer sua função ficar disponível para o usuário via &lt;code&gt;::&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Use &lt;code&gt;@importFrom pkg fun&lt;/code&gt; para importar funções no NAMESPACE (não recomendável)&lt;/li&gt;
  &lt;li&gt;Use Depends se você quiser dar attach de um pacote e usar suas funções (no DESCRIPTION).&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;dados-externos&quot;&gt;Dados externos&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Três maneiras de incluir dados no pacote.&lt;/li&gt;
  &lt;li&gt;Arquivos binários (&lt;code&gt;.RData&lt;/code&gt;) na pasta &lt;code&gt;data/&lt;/code&gt;. Utilizar &lt;code&gt;devtools::usedata()&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Dados utilizados internamente pelas funções em &lt;code&gt;R/sysdata.rda&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Dados em texto (csv, excel, etc), na pasta &lt;code&gt;inst/extdata&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Documentar dados é semelhante a documentar funções, adicionando &lt;code&gt;@format&lt;/code&gt; e &lt;code&gt;@source&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Não é necessário usar &lt;code&gt;@export&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;cdigo-compulado-c-c-etc&quot;&gt;Código compulado (C, C++, etc)&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Usar o pacote &lt;code&gt;RCpp&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Programar em &lt;code&gt;C&lt;/code&gt; e &lt;code&gt;C++&lt;/code&gt; foge do escopo do curso&lt;/li&gt;
  &lt;li&gt;Usando o RStudio e abrindo um novo arquivo, é possível visualizar um template.&lt;/li&gt;
  &lt;li&gt;Usar Ctrl+Shift+B ao invés de &lt;code&gt;devtools::load_all()&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;melhores-prticas&quot;&gt;Melhores práticas&lt;/h1&gt;

&lt;h2 id=&quot;git-e-github&quot;&gt;Git e GitHub&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Versionamento&lt;/li&gt;
  &lt;li&gt;Colaboração&lt;/li&gt;
  &lt;li&gt;Funciona como um website para seu pacote&lt;/li&gt;
&lt;/ul&gt;

&lt;!-- ___________________________________________________________________________________________ --&gt;

&lt;h1 id=&quot;tpico-extra-web-crawling&quot;&gt;Tópico extra: web crawling&lt;/h1&gt;

&lt;h2 id=&quot;filosofia-1&quot;&gt;Filosofia&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Se não tem dados, faça o download dos dados&lt;/li&gt;
  &lt;li&gt;Automatizar acessos a websites&lt;/li&gt;
  &lt;li&gt;É necessário aprender a passear pelos sites (&lt;em&gt;crawling&lt;/em&gt;) e trabalhar com os arquivos HTML (&lt;em&gt;scraping&lt;/em&gt;)&lt;/li&gt;
  &lt;li&gt;Podemos ter uma lista do que queremos inicialmente ou não&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;pacotes&quot;&gt;Pacotes&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Pacotes &lt;code&gt;RCurl&lt;/code&gt; e &lt;code&gt;XML&lt;/code&gt; do Duncan.&lt;/li&gt;
  &lt;li&gt;Pacotes &lt;code&gt;httr&lt;/code&gt; e &lt;code&gt;rvest&lt;/code&gt; do Hadley.&lt;/li&gt;
  &lt;li&gt;Pacote &lt;code&gt;RSelenium&lt;/code&gt; (não funciona muito bem ainda)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;requisies-get-e-post&quot;&gt;Requisições GET e POST&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;GET&lt;/code&gt;: Pede por informação do servidor&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;POST&lt;/code&gt;: Envia infomações para o servidor&lt;/li&gt;
  &lt;li&gt;Para mais detalhes, ver &lt;a href=&quot;http://www.w3schools.com/tags/ref_httpmethods.asp&quot;&gt;aqui&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;cookies-viewstate-etc&quot;&gt;Cookies, viewstate, etc.&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;É bem comum que os sites não queiram que um computador acesse facilmente seus documentos&lt;/li&gt;
  &lt;li&gt;Muitas vezes é preciso mostrar que o usuário “clicou” nos campos necessários para acessar um documento&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;ASP&lt;/code&gt;, &lt;code&gt;ASPX&lt;/code&gt;, &lt;code&gt;JSP&lt;/code&gt; entre outros imprimem valores em &lt;code&gt;tags&lt;/code&gt; na própria página acessada para minimizar acesso automatizado&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;captcha&quot;&gt;Captcha&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Atrapalha a vida dos web crawlers&lt;/li&gt;
  &lt;li&gt;Muitas vezes é difícil de ser quebrado&lt;/li&gt;
  &lt;li&gt;Geralmente são utilizados métodos de machine learning para extrair palavras de imagens&lt;/li&gt;
  &lt;li&gt;Exemplo, serviço &lt;a href=&quot;http://www.deathbycaptcha.com/user/login&quot;&gt;deathbycaptcha&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;exemplo-sabesp&quot;&gt;Exemplo: Sabesp&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Exemplo no R&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;rm_accent &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;gsub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;`|\\&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;iconv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; to &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;ASCII//TRANSLIT&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
renomear &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;substitute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
  x
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

baixa_sabesp &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  link &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;http://www2.sabesp.com.br/mananciais/DivulgacaoSiteSabesp.aspx&amp;#39;&lt;/span&gt;
  txt &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; GET&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;link&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  viewstate &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; txt &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; content&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;#__VIEWSTATE&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html_attr&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  eventval &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; txt &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; content&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;#__EVENTVALIDATION&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html_attr&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  data &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  dados &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cmbDia&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;day&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                cmbMes&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;month&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                cmbAno&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;year&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                Imagebutton1.x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                Imagebutton1.y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&amp;#39;__VIEWSTATE&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;viewstate&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&amp;#39;__EVENTVALIDATION&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;eventval&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  r &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; POST&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;link&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; body&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dados&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; cookies&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;unlist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;txt&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;cookies&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
    nomes &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; r &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; content&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;encoding&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html_nodes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;img&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; html_attr&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;src&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    nomes &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; nomes &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`[`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;str_detect&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nomes&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;jpg&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; str_match&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/(.+)\\.gif&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`[`&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    d &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; r &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      content&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      html&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;encoding&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      html_node&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;#tabDados&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      html_table&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      renomear&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;titulo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;info&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;titulo&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;titulo&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;rm_accent&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;gsub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39; +&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; titulo&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
             lugar&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nomes&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; each&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
             info&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;gsub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;[^0-9.]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;gsub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; info&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      spread&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;titulo&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; info&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; convert&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
      mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;volume_armazenado&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;volume_armazenado&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;d&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

datas &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; today&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; days&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3650&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
d_sabesp &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; datas &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  as.character &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; stringsAsFactors&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  do&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;baixa_sabesp&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;as.character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  ungroup&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

</description>
        <pubDate>Wed, 11 Feb 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula11/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula11/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 10 - Shiny</title>
        <description>&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/slides/aula_10_apresentacao.html&quot; target=&quot;_blank&quot;&gt;Slides dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;informaes-gerais&quot;&gt;Informações gerais&lt;/h2&gt;

&lt;h3 id=&quot;o-que-&quot;&gt;O que é?&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Sistema para desenvolvimento de aplicações web usando o R&lt;/li&gt;
  &lt;li&gt;Um pacote do R (&lt;code&gt;shiny&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;Um servidor web (&lt;code&gt;shiny server&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;o-que-no-&quot;&gt;O que não é&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Uma página web&lt;/li&gt;
  &lt;li&gt;Um substituto para sistemas mais gerais, como Ruby on Rails e Django&lt;/li&gt;
  &lt;li&gt;Uma ferramenta gerencial, como o Tableau&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;desenvolvimento-web&quot;&gt;Desenvolvimento web&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://programmers.stackexchange.com/a/171210&quot; title=&quot;diferencas&quot;&gt;Server side &lt;em&gt;versus&lt;/em&gt; user side&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Quando surfamos na web, nos &lt;em&gt;comunicamos&lt;/em&gt; com servidores do mundo inteiro, geralmente através
do protocolo HTTP.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;server-side&quot;&gt;Server side&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Processa requisições e dados do cliente, estrutura e envia páginas web, interage com banco de 
dados, etc.&lt;/li&gt;
  &lt;li&gt;Linguagens: PHP, C#, Java, R, etc (virtualmente qualquer linguagem de programação).&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;user-side&quot;&gt;User side&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;Cria interfaces gráfica a partir dos códigos recebidos pelo servidor, envia e recebe
informações do servidor, etc.&lt;/li&gt;
  &lt;li&gt;“Linguagens” mais usuais: HTML, CSS e JavaScript.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;onde-est-o-shiny-nisso-tudo&quot;&gt;Onde está o Shiny nisso tudo?&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;O código de uma aplicação shiny fica no &lt;em&gt;server side&lt;/em&gt;.&lt;/li&gt;
  &lt;li&gt;O shiny permite que um computador (servidor) envie páginas web, receba informações do usuário e 
processe dados, utilizando apenas o R.&lt;/li&gt;
  &lt;li&gt;Para rodar aplicativos shiny, geralmente estruturamos a parte relacionada ao HTML, JavaScript e 
CSS no arquivo &lt;code&gt;ui.R&lt;/code&gt;, e a parte relacionada com processamento de dados e geração de gráficos e 
análises no arquivo &lt;code&gt;server.R&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Os arquivos &lt;code&gt;ui.R&lt;/code&gt; e &lt;code&gt;server.R&lt;/code&gt; ficam no servidor!&lt;/li&gt;
  &lt;li&gt;Atualmente é possível construir 
&lt;a href=&quot;http://shiny.rstudio.com/articles/single-file.html&quot;&gt;aplicativos em um arquivo só&lt;/a&gt;, mas vamos manter 
a estrutura de &lt;code&gt;ui.R&lt;/code&gt; e &lt;code&gt;server.R&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;e-pra-que-serve-o-shiny-server&quot;&gt;E pra que serve o shiny server?&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;O pacote &lt;code&gt;shiny&lt;/code&gt; do R possui internamente um servidor web básico, geralmente utilizado para
aplicações locais, permitindo somente uma aplicação por vez.&lt;/li&gt;
  &lt;li&gt;O &lt;code&gt;shiny server&lt;/code&gt; é um programa que roda somente em Linux que permite o acesso a múltiplas
aplicações simultaneamente.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;como-funciona&quot;&gt;Como funciona&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Baseado no &lt;a href=&quot;http://shiny.rstudio.com/tutorial&quot; title=&quot;tutorial&quot;&gt;tutorial do Shiny pelo RStudio&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;comeando-com-um-exemplo&quot;&gt;Começando com um exemplo&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;shiny&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;runGitHub&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;abjur/vistemplate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; subdir&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;exemplo_01_helloworld&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;construindo-uma-interface-no-user-side&quot;&gt;Construindo uma interface no user side&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Shiny utiliza como padrão o &lt;a href=&quot;http://getbootstrap.com/css/&quot;&gt;bootstrap css&lt;/a&gt; do &lt;a href=&quot;https://twitter.com&quot;&gt;Twitter&lt;/a&gt;, que é bonito e responsivo (lida bem com várias plataformas).&lt;/li&gt;
  &lt;li&gt;Criar páginas básicas com &lt;code&gt;pageWithSidebar&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Páginas mais trabalhadas com &lt;code&gt;fluidPage&lt;/code&gt;, &lt;code&gt;fluidRow&lt;/code&gt;, &lt;code&gt;column&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Pesquisar outros tipos de layouts no shiny.&lt;/li&gt;
  &lt;li&gt;Criar páginas web customizadas direto no HTML.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;adicionando-widgets&quot;&gt;Adicionando widgets!&lt;/h3&gt;

&lt;p&gt;Acesse &lt;a href=&quot;http://shiny.rstudio.com/gallery/widget-gallery.html&quot; title=&quot;widgets&quot;&gt;neste link&lt;/a&gt; ou rode&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;shiny&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;runGitHub&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;garrettgman/shinyWidgets&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;exerccio&quot;&gt;Exercício&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Criar um &lt;code&gt;pageWithSideBar&lt;/code&gt; com dois &lt;code&gt;wellPanel&lt;/code&gt;, um &lt;code&gt;dateInput&lt;/code&gt;, um &lt;code&gt;checkboxGroup&lt;/code&gt; e um &lt;code&gt;textInput&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Aprender &lt;code&gt;fluidRow&lt;/code&gt; e &lt;code&gt;column&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;criando-outputs&quot;&gt;Criando outputs&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Imagine que para cada função &lt;code&gt;xxOutput(&#39;foo&#39;, ...)&lt;/code&gt; do &lt;code&gt;ui.R&lt;/code&gt; você pode colocar um código do tipo 
&lt;code&gt;output$foo &amp;lt;- renderXX(...)&lt;/code&gt; no &lt;code&gt;server.R&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;A função no arquivo &lt;code&gt;ui.R&lt;/code&gt; determina a localização e identificação do elemento&lt;/li&gt;
  &lt;li&gt;Criando gráficos com &lt;code&gt;plotOutput&lt;/code&gt; e &lt;code&gt;renderPlot&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Exibindo dados com &lt;code&gt;dataTableOutput&lt;/code&gt; e &lt;code&gt;renderDataTable&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;exerccio-1&quot;&gt;Exercício&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Criar um output de gráfico contento &lt;code&gt;pairs(mtcars[1:3])&lt;/code&gt; e um output de dados contendo &lt;code&gt;cor(mtcars[1:3])&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;escopo&quot;&gt;Escopo&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;server.R&lt;/code&gt;, dentro e fora&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;global.R&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Sessões&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;modelo-de-reatividade&quot;&gt;Modelo de Reatividade&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Determina o quê vai rodar e em que ordem no arquivo &lt;code&gt;server.R&lt;/code&gt;, dependendo das ações do usuário.&lt;/li&gt;
  &lt;li&gt;É uma tentativa de resolver a falta de tratamento de eventos no R.&lt;/li&gt;
  &lt;li&gt;É importante pois impede que cálculos desnecessários sejam repetidos.&lt;/li&gt;
  &lt;li&gt;Só funciona se for programado adequadamente.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;objetos-reativos&quot;&gt;Objetos reativos&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Fonte (source): geralmente acessível no objeto &lt;code&gt;input&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Ponto final (endpoint): geralmente acessível no objeto &lt;code&gt;output&lt;/code&gt;. Implementado através de 
&lt;code&gt;observers&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Condutores: geralmente implementado através da função &lt;code&gt;reactive&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;construindo-grafo-de-invalidao&quot;&gt;Construindo grafo de invalidação&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;assets/fig/faithful.png&quot; alt=&quot;Invalidacao1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/fig/conductor.png&quot; alt=&quot;Invalidacao2&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;exerccio-2&quot;&gt;Exercício&lt;/h4&gt;

&lt;p&gt;Construa o grafo de invalidação do aplicativo construído nos exercícios anteriores.&lt;/p&gt;

&lt;hr /&gt;

&lt;h4 id=&quot;mais-informaes&quot;&gt;Mais informações&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;reactive&lt;/code&gt;: Utilizar para realizar computações pesadas ou cálculos utilizados em várias partes da
aplicação.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;observe&lt;/code&gt;: Utilizar para guardar dados internamente, arquivos de log, etc. Também pode ser útil
para trabalhar com widgets personalizados.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;isolate&lt;/code&gt;: Utilizar para cancelar a dependência de um valor reativo em um condutor ou ponto 
final, para poupar computações ou executar lógicas mais complexas.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;shiny&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;runGitHub&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;rstudio/shiny-examples&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; subdir&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;055-observer-demo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;fazendo-mais-com-o-shiny&quot;&gt;Fazendo mais com o shiny&lt;/h2&gt;

&lt;h3 id=&quot;construindo-inputs-e-outputs-personalizados&quot;&gt;Construindo inputs e outputs personalizados&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Geralmente necessita de implementações de &lt;em&gt;bindings&lt;/em&gt; em R, HTML e JavaScript.&lt;/li&gt;
  &lt;li&gt;Dependendo do caso, a criação de bindings pode ser “pulada” utilizando funções que injetam
JavaScript na página e a função &lt;code&gt;renderUI&lt;/code&gt; (geralmente menos eficiente).&lt;/li&gt;
  &lt;li&gt;Não dá tempo de abordar no curso. Ler 
&lt;a href=&quot;http://shiny.rstudio.com/articles/building-inputs.html&quot;&gt;aqui&lt;/a&gt; e 
&lt;a href=&quot;http://shiny.rstudio.com/articles/building-outputs.html&quot;&gt;aqui&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;shiny-server-pro&quot;&gt;Shiny Server Pro&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Licensa comercial do Shiny-server&lt;/li&gt;
  &lt;li&gt;Possui algumas características a mais, como autenticação e suporte.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;shinyappsio&quot;&gt;shinyapps.io&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Para compartilhar um aplicativo shiny, geralmente precisamos ter um servidor Linux (geralmente
utilizando algum serviço na cloud como AWS ou DigitalOcean) com o shiny server instalado.&lt;/li&gt;
  &lt;li&gt;Isso pode ser doloroso.&lt;/li&gt;
  &lt;li&gt;O shinyapps.io é um sistema (que envolve tanto pacote do R como uma página web) que permite que o 
usuário coloque sua aplicação shiny na web sem muito esforço.&lt;/li&gt;
  &lt;li&gt;O serviço está sendo desenvolvido pela RStudio Inc. e terá contas grátis e pagas.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;ainda-mais&quot;&gt;Ainda mais!&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Ferramenta em amplo desenvolvimento.&lt;/li&gt;
  &lt;li&gt;Grande oportunidade na área acadêmica e profissional.&lt;/li&gt;
  &lt;li&gt;Potencial de revolucionar as formas atuais de comunicação.&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Mon, 09 Feb 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula10/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula10/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 09 - Laboratório III</title>
        <description>
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(pander): there is no package called &amp;#39;pander&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;panderOptions&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pacotes necessários para o Lab. III&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;magrittr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tidyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;jpeg&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(tree): there is no package called &amp;#39;tree&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1 id=&quot;laboratrio-iii---recuperao-de-imagem&quot;&gt;Laboratório III - Recuperação de imagem&lt;/h1&gt;

&lt;p&gt;Neste laboratório iremos comparar visualmente o desempenho de modelos de &lt;strong&gt;regressão linear&lt;/strong&gt; e de &lt;strong&gt;árvores de decisão&lt;/strong&gt; em duas diferentes situações.&lt;/p&gt;

&lt;p&gt;Para isso, iremos mexer com imagens &lt;strong&gt;.jpg&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;imagens-jpg&quot;&gt;Imagens &lt;strong&gt;.jpg&lt;/strong&gt;&lt;/h2&gt;

&lt;p&gt;Antes de iniciarmos a brincadeira, vale uma breve introdução às imagens &lt;strong&gt;.jpg&lt;/strong&gt;, pois elas formarão os &lt;code&gt;data.frame&lt;/code&gt;’s do laboratório.&lt;/p&gt;

&lt;p&gt;Arquivos com extenção &lt;em&gt;.jpg&lt;/em&gt; guardam 5 coordenadas que são suficientes para serem entendidas e desenhadas pelo computador:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;x&lt;/code&gt; e &lt;code&gt;y&lt;/code&gt; são as coordenadas cartesianas da imagem; e&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;r&lt;/code&gt;, &lt;code&gt;g&lt;/code&gt; e &lt;code&gt;b&lt;/code&gt; &lt;em&gt;red&lt;/em&gt;, &lt;em&gt;green&lt;/em&gt; e &lt;em&gt;blue&lt;/em&gt;, respectivamente, que juntas formam cores.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Todas as cores que conhecemos podem ser compostas pela combinação dessas três cores. A intensidade de cada cor varia de 0 a 1.&lt;/p&gt;

&lt;p&gt;Para cada ponto no plano (x,y) existe uma cor associada. Assim, uma imagem pode ser representada por um banco de dados com 5 colunas: &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt;, &lt;code&gt;r&lt;/code&gt;, &lt;code&gt;g&lt;/code&gt; e &lt;code&gt;b&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;objetivo&quot;&gt;Objetivo&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Verificar qual modelo entre &lt;strong&gt;regressão linear&lt;/strong&gt; e &lt;strong&gt;árvores de decisão&lt;/strong&gt; é o mais adequado para recuperar a o componente azul da imagem &lt;strong&gt;purple_wave.jpg&lt;/strong&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Verificar qual modelo entre &lt;strong&gt;regressão linear&lt;/strong&gt; e &lt;strong&gt;árvores de decisão&lt;/strong&gt; é o mais adequado para recuperar a o componente azul da imagem &lt;strong&gt;xadrez_colorido.jpg&lt;/strong&gt;.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;preparao-do-banco-de-dados&quot;&gt;Preparação do Banco de dados&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;Para construir nossos bancos de dados, carregue as duas imagens abaixo (clique para download e salve na pasta do seu projeto):
    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;http://curso-r.github.io/posts/assets/fig/purple_wave.jpg&quot;&gt;purple_wave.jpg&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;http://curso-r.github.io/posts/assets/fig/xadrez_colorido.jpg&quot;&gt;xadrez_colorido.jpg&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Com auxílio da função &lt;code&gt;readJPEG()&lt;/code&gt; do pacote &lt;code&gt;jpeg&lt;/code&gt;, carregue uma das imagens no R e transforme para &lt;code&gt;data.frame&lt;/code&gt; (primeiro a &lt;em&gt;purple_wave.jpg&lt;/em&gt;).&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# a) carrega uma imagem jpeg no R &lt;/span&gt;
img &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; readJPEG&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;assets/fig/purple_wave.jpg&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# b) transforma o array da imagem em data.frame com infos de posicao (x,y) e cor (r,g,b)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# dimensões da imagem&lt;/span&gt;
img_dim &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;img&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# RGB para data.frame&lt;/span&gt;
img_df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
  x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;img_dim&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; each &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; img_dim&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
  y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;img_dim&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; img_dim&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
  r &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;img&lt;span class=&quot;p&quot;&gt;[,,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
  g &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;img&lt;span class=&quot;p&quot;&gt;[,,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
  b &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;img&lt;span class=&quot;p&quot;&gt;[,,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cor &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; rgb&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
         id &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Divida o data.frame em duas partes: uma com o azul (coluna &lt;code&gt;b&lt;/code&gt;) e outra sem.&lt;/li&gt;
&lt;/ol&gt;

&lt;ul&gt;
  &lt;li&gt;Parte 1) &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt;, &lt;code&gt;r&lt;/code&gt;, &lt;code&gt;g&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Parte 2) &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt;, &lt;code&gt;r&lt;/code&gt;, &lt;code&gt;g&lt;/code&gt;, &lt;code&gt;b&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# para reprodução&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;# Parte 1) x, y, r, g&lt;/span&gt;
img_df_parte1 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; img_df &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  sample_frac&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# separando 3/5 do banco&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;b_backup &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# backup do azul original&lt;/span&gt;
         b &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# retirando o azul da imagem&lt;/span&gt;
         cor &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; rgb&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# cor da imagem sem o azul&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Parte 2) x, y, r, g, b&lt;/span&gt;
img_df_parte2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; img_df &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;id&lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt;img_df_parte1&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;id&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# filtra as linhas que estão na Parte 1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;Visualize.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Veja como fica a &lt;strong&gt;imagem original sem o azul&lt;/strong&gt; e como é o &lt;strong&gt;azul original isolado&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Imagem sem o azul&lt;/span&gt;
ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; img_df_parte1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; img_df_parte1&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;cor&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  labs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;x&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;y&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; title &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Imagem sem B (azul)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_fixed&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ratio &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  theme_bw&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-22-aula09/unnamed-chunk-5-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-5&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Apenas o azul da imagem&lt;/span&gt;
ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; img_df_parte2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; img_df_parte2&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;cor&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  labs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;x&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;y&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; title &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Imagem sem B (azul)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_fixed&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ratio &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  theme_bw&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-22-aula09/unnamed-chunk-5-2.png&quot; alt=&quot;plot of chunk unnamed-chunk-5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A sua tarefa é recuperar o azul (&lt;code&gt;b&lt;/code&gt;) da &lt;strong&gt;Parte 1&lt;/strong&gt; que apagamos utilizando modelos preditivos construídos com a &lt;strong&gt;Parte 2&lt;/strong&gt; (que ainda tem o azul!). Vamos aos exercícios.&lt;/p&gt;

&lt;h2 id=&quot;exerccios&quot;&gt;Exercícios&lt;/h2&gt;

&lt;h3 id=&quot;exerccio-1-descritiva&quot;&gt;Exercício 1: Descritiva&lt;/h3&gt;

&lt;p&gt;Construa para &lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt;, &lt;code&gt;r&lt;/code&gt;, &lt;code&gt;g&lt;/code&gt;, &lt;code&gt;b&lt;/code&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A matriz de correlação linar e arredonde os resultados para duas casas decimais (utilize a função &lt;code&gt;cor()&lt;/code&gt;);&lt;/li&gt;
  &lt;li&gt;A matriz de gráficos de dispersão (use a função &lt;code&gt;pairs()&lt;/code&gt;).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;DICA:&lt;/strong&gt; faça esse exercício com uma amostra de 500 linhas do &lt;code&gt;img_df&lt;/code&gt;, pois é muito pesado com o banco inteiro.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# uma amostra de 500 pontos para a análise descritiva (usar o banco inteiro é desnecessário e demorado)&lt;/span&gt;
img_df_amostra &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; img_df &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  sample_n&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;replace &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;exerccio-2-modelo-de-regresso-linear&quot;&gt;Exercício 2: Modelo de Regressão Linear&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Com base na análise descritiva do exercício anterior, proponha um preditor para &lt;code&gt;b&lt;/code&gt; e traduza para o R como uma fórmula;&lt;/li&gt;
  &lt;li&gt;Ajuste uma &lt;strong&gt;regressão linear&lt;/strong&gt; utilizando a fórmula proposta e a função &lt;code&gt;lm()&lt;/code&gt;;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;LEMBRETE:&lt;/strong&gt; fórmulas de modelos deixam a resposta à esquerda do &lt;code&gt;~&lt;/code&gt; e as preditivas/explicativas à direita.&lt;/p&gt;

&lt;h3 id=&quot;exerccio-3-modelo-de-rvore-de-deciso&quot;&gt;Exercício 3: Modelo de Árvore de Decisão&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Com base na análise descritiva do exercício anterior, escolha as variáveis para predizer &lt;code&gt;b&lt;/code&gt; e passe como uma fórmula à função.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Ajuste uma &lt;strong&gt;árvore de decisão&lt;/strong&gt; por meio da função &lt;code&gt;tree()&lt;/code&gt; do pacote &lt;code&gt;tree&lt;/code&gt;, passando a fórmula com as variáveis escolhidas.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;exerccio-4-comparao&quot;&gt;Exercício 4: Comparação&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Calcule o erro de predição.&lt;/li&gt;
  &lt;li&gt;Desenhe o original e o predito.&lt;/li&gt;
  &lt;li&gt;Qual ficou melhor?&lt;/li&gt;
  &lt;li&gt;Você acha que o padrão da imagem (transições suaves de cor) influenciou neste resultado? Por quê?&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;exerccio-5-outra-imagem&quot;&gt;Exercício 5: Outra Imagem&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Repita os exercícios de 1 a 4, mas agora para a imagem &lt;em&gt;xadrez_colorido.jpg&lt;/em&gt;.&lt;/li&gt;
  &lt;li&gt;Quanto ao desempenho para recuperar o azul de imagens, teve uma técnica melhor?&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;exerccio-extra-opcional-imagens-da-internet&quot;&gt;Exercício Extra (opcional): Imagens da Internet&lt;/h2&gt;

&lt;p&gt;Crie duas &lt;em&gt;strings&lt;/em&gt; no R, &lt;code&gt;link_lm&lt;/code&gt; e &lt;code&gt;link_tree&lt;/code&gt;, cada uma contendo, respectivamente:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Um link para uma imagem que seria bem recuperada pelo modelo de &lt;strong&gt;regressão linear&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;Um link para uma imagem que seria bem recuperada pelo modelo de &lt;strong&gt;árvore de decisão&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;

</description>
        <pubDate>Fri, 06 Feb 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula09/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula09/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 08 - Aula dos alunos</title>
        <description>&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/slides/aula_08_apresentacao.html&quot; target=&quot;_blank&quot;&gt;Slides dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;parte-1-um-pouco-mais-de-modelos&quot;&gt;Parte 1: Um pouco mais de modelos&lt;/h1&gt;

&lt;h2 id=&quot;modelos-de-sobrevivncia&quot;&gt;Modelos de sobrevivência&lt;/h2&gt;

&lt;p&gt;A Análise de Sobrevivência compreende os estudos em que o interesse principal é avaliar o tempo até a ocorrência de um evento pré-determinado. Esses tempos, chamados de &lt;em&gt;tempos de falha&lt;/em&gt;, podem, então, ser explicados por outras variáveis a partir de modelos de regressão paramétricos ou semi-paramétricos. Uma característica fundamental desse tipo de estudo é a presença de censura, definida como a observação parcial do tempo de falha.&lt;/p&gt;

&lt;p&gt;Para ilustrar as funções discutidas aqui, utilizaremos o banco de dados &lt;code&gt;ovarian&lt;/code&gt;, do pacote &lt;code&gt;survival&lt;/code&gt;. Este banco traz o tempo de sobrevivência (ou censura) de 26 mulheres com câncer de ovário e o objetivo do estudo foi comparar dois tratamentos distintos para essa doença.&lt;/p&gt;

&lt;p&gt;Nesse exemplo, o tempo de falha é o intervalo entre a entrada no estudo e a ocorrência do evento de interesse que, aqui, é a morte da paciente. A censura neste caso é causada pelo abandono do estudo ou pela não ocorrência do evento até o fim do acompanhamento, ou seja, os casos em que a paciente estava viva no fim do estudo.&lt;/p&gt;

&lt;p&gt;Para mais informações sobre o banco de dados, consulte o &lt;code&gt;help(ovarian)&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Para mais informações sobre Análise de Sobrevivência, consultar as seguintes referências:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Colosimo, E.A. e Giolo, S.R.. (2005) Análise de Sobrevivência Aplicada. ABE — Projeto fisher. Editora Edgard Blucher&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Kalbfleisch, J. D.; Prentice, Ross L. (2002). The statistical analysis of failure time data. New York: John Wiley &amp;amp; Sons.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Lawless, Jerald F. (2003). Statistical Models and Methods for Lifetime Data (2nd ed.). Hoboken: John Wiley and Sons.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;kaplan-meier-e-log-rank&quot;&gt;Kaplan-Meier e Log-rank&lt;/h3&gt;

&lt;p&gt;O Kaplan-Meier é a principal ferramenta para visualizar dados de sobrevivência. Esses gráficos ajustam curvas tipo-escada da proporção de indivíduos &lt;em&gt;em risco&lt;/em&gt; — que ainda não falharam e não foram censurados — ao longo do tempo. Para plotar um Kaplan-Meier no R, utilizamos a função &lt;code&gt;survfit()&lt;/code&gt; e a função &lt;code&gt;plot()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; survfit&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Surv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;futime&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fustat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; rx&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ovarian&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-23-aula08/unnamed-chunk-2-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Também podemos construir um Kaplan-Meier com o &lt;code&gt;ggplot2&lt;/code&gt;, mas observe que é necessário fazer algums modificações no objeto &lt;code&gt;fit&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;m &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;strata&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;time &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;time&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                 surv &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; m&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;surv&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                 group &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;strata&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                          &lt;span class=&quot;kp&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;strata&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;strata&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; df&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;  
        geom_step&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; time&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; surv&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
        ylim&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
        labs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Curvas&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Proporção de sobreviventes&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Tempo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-23-aula08/unnamed-chunk-3-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;O teste de log-rank para comparação de grupos é realizado pela função &lt;code&gt;survdiff()&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;survdiff&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Surv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;futime&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fustat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; rx&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ovarian&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Call:
## survdiff(formula = Surv(futime, fustat) ~ rx, data = ovarian)
## 
##       N Observed Expected (O-E)^2/E (O-E)^2/V
## rx=1 13        7     5.23     0.596      1.06
## rx=2 13        5     6.77     0.461      1.06
## 
##  Chisq= 1.1  on 1 degrees of freedom, p= 0.303&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;modelos-paramtricos&quot;&gt;Modelos paramétricos&lt;/h3&gt;

&lt;p&gt;Para ajustar modelos paramétricos, podemos utilizar a função &lt;code&gt;survreg()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; survreg&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Surv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;futime&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fustat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; rx &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; age&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ovarian&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               dist &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;exponential&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## survreg(formula = Surv(futime, fustat) ~ rx + age, data = ovarian, 
##     dist = &amp;quot;exponential&amp;quot;)
##              Value Std. Error     z        p
## (Intercept) 12.123     2.3966  5.06 4.23e-07
## rx           0.661     0.6159  1.07 2.83e-01
## age         -0.105     0.0319 -3.30 9.81e-04
## 
## Scale fixed at 1 
## 
## Exponential distribution
## Loglik(model)= -91.2   Loglik(intercept only)= -98
## 	Chisq= 13.65 on 2 degrees of freedom, p= 0.0011 
## Number of Newton-Raphson Iterations: 5 
## n= 26&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Observe que no exemplo acima utilizamos a distribuição Exponencial. O argumento &lt;code&gt;dist = &lt;/code&gt; pode ser modificado para ajustarmos modelos com outras distribuições:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;dist = &quot;weibull&quot;&lt;/code&gt; — distribuição Weibull (default)&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;dist = &quot;gaussian&quot;&lt;/code&gt; — distribuição Normal&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;dist = &quot;logistic&quot;&lt;/code&gt; — distribuição Logística&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;dist = &quot;lognormal&quot;&lt;/code&gt; — distribuição Log-normal&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;dist = &quot;loglogistic&quot;&lt;/code&gt; — distribuição Log-logística&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;modelo-semi-paramtrico-de-cox&quot;&gt;Modelo semi-paramétrico de Cox&lt;/h3&gt;

&lt;p&gt;No R, a função mais utilizada para ajustar modelos de Cox é a &lt;code&gt;coxph()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; coxph&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Surv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;futime&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fustat&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; age &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; rx&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ovarian&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Call:
## coxph(formula = Surv(futime, fustat) ~ age + rx, data = ovarian)
## 
##   n= 26, number of events= 12 
## 
##         coef exp(coef) se(coef)      z Pr(&amp;gt;|z|)   
## age  0.14733   1.15873  0.04615  3.193  0.00141 **
## rx  -0.80397   0.44755  0.63205 -1.272  0.20337   
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
##     exp(coef) exp(-coef) lower .95 upper .95
## age    1.1587      0.863    1.0585     1.268
## rx     0.4475      2.234    0.1297     1.545
## 
## Concordance= 0.798  (se = 0.091 )
## Rsquare= 0.457   (max possible= 0.932 )
## Likelihood ratio test= 15.89  on 2 df,   p=0.0003551
## Wald test            = 13.47  on 2 df,   p=0.00119
## Score (logrank) test = 18.56  on 2 df,   p=9.341e-05&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;generalized-additive-model-gam&quot;&gt;Generalized Additive Model (GAM)&lt;/h2&gt;

&lt;p&gt;Os modelos aditivos generalizados ou GAM são modelos baseados na teoria desenvolvida por Trevor
Hastie e Robert Tibshirani, e podem ser vistos como uma generalização de GLM, no sentido de que todos os
GLM sãoo casos particulares de GAM.&lt;/p&gt;

&lt;p&gt;Na regressão normal e em GLM assumimos, em geral, que as variáveis aleatórias correspondentes aos indivíduos são independentes, e que existe uma função, denominada função de ligação, que une as médias destas variáveis aleatórias a um certo preditor linear.&lt;/p&gt;

&lt;p&gt;A grande mudança nos modelos aditivos generalizados está na forma do preditor. Para cada variável explicativa, temos associada uma função a ser estimada (ou suavizada), sendo que o preditor fica definido como a soma dessas funções&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;g(\mu_i) = f_0 + \sum f(x_{ij})&lt;/script&gt;

&lt;p&gt;Para evitar o desconforto da interpretação das contribuições marginais (funções), uma alternativa é utilizar as funções de suavização para ajustar variáveis de controle em que não há interesse direto, e manter a parte principal com termos paramétricos. Geralmente isso facilita a interpretação e melhora o ajuste do modelo em relação ao GLM.&lt;/p&gt;

&lt;h3 id=&quot;pacote-mgcv&quot;&gt;Pacote mgcv&lt;/h3&gt;

&lt;p&gt;O pacote &lt;code&gt;mgcv&lt;/code&gt; é um dos pacotes mais completos do R e permite simulação, ajuste, visualização e análise de resíduos para &lt;code&gt;gam&lt;/code&gt;. O pacote gerou até &lt;a href=&quot;http://books.google.co.uk/books?id=hr17lZC-3jQC&quot;&gt;um livro&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Na prática, a utilização do GAM não difere muito de modelos GLM. Uma das únicas diferenças na especificação do modelo é que podemos utilizar a função &lt;code&gt;s&lt;/code&gt; para determinar quais termos queremos que sejam ajustados com funções aditivas.&lt;/p&gt;

&lt;h4 id=&quot;exemplo-pnud&quot;&gt;Exemplo: PNUD&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;data&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pnud_muni&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; package&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;abjutils&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in find.package(package, lib.loc, verbose = verbose): there is no package called &amp;#39;abjutils&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mgcv&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Carregando pacotes exigidos: nlme
## This is mgcv 1.8-7. For overview type &amp;#39;help(&amp;quot;mgcv-package&amp;quot;)&amp;#39;.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fit_model &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; gam&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;espvida &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; ano &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; s&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rdpc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; s&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i_escolaridade&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pnud_muni&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Gamma&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in is.data.frame(data): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit_model&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in summary(fit_model): objeto &amp;#39;fit_model&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;par&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mfrow&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit_model&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scheme&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(fit_model, scheme = 1): objeto &amp;#39;fit_model&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;pacote-gamlss&quot;&gt;Pacote gamlss&lt;/h3&gt;

&lt;p&gt;Se por algum motivo existir algum problema na análise em relação à distribuição, heterocedasticidade, e utilização de preditores lineares, uma possível alternativa é o GAMLSS.&lt;/p&gt;

&lt;p&gt;GAMLSS significa Generalized Additive Models for Location, Scale and Shape. Com GAMLSS é possível modelar não só a média da distribuição $\mu_i$ (primeiro momento), mas também a variância $\sigma_i$ (segundo momento), a assimetria $\phi_i$ (terceiro momento) e a curtose $\rho_i$ (quarto momento), usando preditores.&lt;/p&gt;

&lt;p&gt;Por ser um modelo aditivo, o GAMLSS permite que sejam adicionados termos de suavização na fórmula do modelo, o que o torna uma generalização natural do GAM (em relação à modelagem, não ao método de ajuste).&lt;/p&gt;

&lt;p&gt;Por fim, o modelo GAMLSS possui &lt;strong&gt;mais de 50&lt;/strong&gt; famílias de distribuições implementadas, o que nos dá uma enorme gama de opções para criação de modelos.&lt;/p&gt;

&lt;p&gt;Também é possível adicionar efeitos aleatórios utilizando o GAMLSS, mas essa parte ainda é experimental.&lt;/p&gt;

&lt;p&gt;Mas tudo vem com um preço. Por ser um grande canhão, o método de ajuste de modelos GAMLSS geralmente são baseados técnicas de otimização aproximadas. Além disso, o ajuste de modelos pode ser mais lento que os concorrentes. Por fim, a análise de resíduos para GAMLSS é bastante limitada (e provavelmente continuará sendo).&lt;/p&gt;

&lt;p&gt;Recomendamos a utilização do &lt;code&gt;gamlss&lt;/code&gt; com muito cuidado, e sempre acompanhando outras modelagens, usando &lt;code&gt;glm&lt;/code&gt; ou &lt;code&gt;gam&lt;/code&gt;, por exemplo.&lt;/p&gt;

&lt;h4 id=&quot;exemplo-pnud-1&quot;&gt;Exemplo: PNUD&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;gamlss&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(gamlss): there is no package called &amp;#39;gamlss&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Cuidado! O pacote gamlss carrega MASS, que por sua vez mascara a função select do dplyr.&lt;/span&gt;

dados &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  dplyr&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rdpc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; i_escolaridade&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; espvida&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ano&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  na.omit &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;%&amp;gt;%&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fit_model &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; gamlss&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;formula&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;espvida &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; cs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rdpc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; cs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;i_escolaridade&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                    sigma.formula &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dados&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                    family&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NET&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;gamlss&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit_model&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in summary(fit_model): objeto &amp;#39;fit_model&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fit_model&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(fit_model): objeto &amp;#39;fit_model&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Leitura:&lt;/strong&gt; Iniciação científica: &lt;a href=&quot;https://www.dropbox.com/s/du1h5kmunmwjl65/iniciacao.pdf?dl=0&quot;&gt;De GLM a GAMLSS&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;modelos-bayesianos&quot;&gt;Modelos Bayesianos&lt;/h2&gt;

&lt;p&gt;A comunidade bayesiana do &lt;code&gt;R&lt;/code&gt; é cada vez maior, e muitas técnicas estão surgindo com o passar dos anos. A cada dia temos novas contribuições, e pode-se dizer que hoje o &lt;code&gt;R&lt;/code&gt; é uma das melhores plataformas para utilização de modelos bayesianos no mundo.&lt;/p&gt;

&lt;h3 id=&quot;um-pouco-muito-pouco-de-teoria&quot;&gt;Um pouco (muito pouco) de teoria&lt;/h3&gt;

&lt;p&gt;A diferença primordial dos modelos bayesianos para os modelos clássicos / frequentistas nasce da interpretação da probabilidade. Segundo a teoria bayesiana, a probabilidade é subjetiva e está associada com a opinião de um indivíduo acerca de um evento, que é incerto.&lt;/p&gt;

&lt;p&gt;Traduzindo para modelos, os parâmetros de um modelo (que são nossas quantidades de interesse) não são mais tratados como pontos a serem estimados, mas sim como variâveis aleatórias a serem estudadas.&lt;/p&gt;

&lt;p&gt;A ideia é que, em cada estudo, o pesquisador tenha uma ideia de como se comporta o seu parâmetro de interesse, e possa traduzir essa ideia na forma de uma distribuição de probabilidades (&lt;em&gt;priori&lt;/em&gt;). Depois, os dados são observados e, com isso, a opinião inicial é atualizada (&lt;em&gt;posteriori&lt;/em&gt;). A estatística bayesiana utiliza um brilhante algoritmo para realizar essa atualização, que é o Teorema de Bayes.&lt;/p&gt;

&lt;p&gt;A grande dificuldade em modelos bayesianos ocorre porque o algoritmo de atualização da distribuição de probabilidades muitas vezes necessita que calculemos algumas integrais extremamente difíceis (impossíveis analiticamente, e muito difíceis computacionalmente).&lt;/p&gt;

&lt;p&gt;Tenha em mente que os pacotes de análise bayesiana geralmente focam nesse problema: como simular dados da distribuição &lt;em&gt;a posteriori&lt;/em&gt;. A maioria dos algoritmos que tentam resolver essa tarefa são baseados em técnicas MCMC (Markov Chains Monte Carlo), que basicamente são meios de simular dados nas regiões de maior massa da posteriori.&lt;/p&gt;

&lt;p&gt;Estatística bayesiana é muito simples na teoria, mas os modelos podem ser bem demorados para serem ajustados, e existe um espaço amplo para subjetividades na hora de escolher a melhor metodologia para simular da posteriori.&lt;/p&gt;

&lt;h3 id=&quot;pacotes-que-fazem-anlise-bayesiana&quot;&gt;Pacotes que fazem análise bayesiana&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;rjags&lt;/code&gt;: Forma de utilizar o software JAGS no R (geralmente para fazer MCMC).&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;R2WinBUGS&lt;/code&gt; e &lt;code&gt;rbugs&lt;/code&gt;: Forma de utilizar o WinBugs e o OpenBugs no R.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;LaplacesDemon&lt;/code&gt;: Pacote completamente implementado em R para inferência bayesiana.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Acesse &lt;a href=&quot;http://cran.r-project.org/web/views/Bayesian.html&quot;&gt;aqui&lt;/a&gt; para uma lista completa de pacotes.&lt;/p&gt;

&lt;h3 id=&quot;laplacesdemon&quot;&gt;LaplacesDemon&lt;/h3&gt;

&lt;p&gt;O pacote &lt;code&gt;LaplacesDemon&lt;/code&gt;, ou simplesmente LD, é um gigantesco framework do R para realização de análise bayesiana de dados. É interessante notar que houve uma preocupação grande em tornar o código todo disponível em &lt;code&gt;R&lt;/code&gt;, tanto que, por conta dos problemas de performance, foi criado também o pacote &lt;code&gt;LaplacesDemonCpp&lt;/code&gt;, que tem suas funções implementadas em &lt;code&gt;C++&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Para mais informações sobre o pacote LD, ver &lt;a href=&quot;&quot;&gt;aqui&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Para realizar uma análise bayesiana, geralmente o que sabemos é a nossa &lt;em&gt;priori&lt;/em&gt;, a função de verossimilhança (ambas determinadas de pelo estatístico ou pesquisador) e os dados colhidos em uma amostra. Nosso objetivo é obter a posteriori&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;f(\theta|x) = \frac{l(x | \theta)f(\theta)}{\int_{\theta} l(x|\theta)f(\theta)}&lt;/script&gt;

&lt;p&gt;Para exemplos de uso do LD, ver&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;vignette&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;Examples&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; package &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;LaplacesDemon&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Algumas categorias de técnicas para realizar a aproximação bayesiana são&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ABC (Aproximate Bayesian Computation)&lt;/li&gt;
  &lt;li&gt;Importance Sampling&lt;/li&gt;
  &lt;li&gt;Iterative Quadrature&lt;/li&gt;
  &lt;li&gt;Laplace Aproximation&lt;/li&gt;
  &lt;li&gt;MCMC (Markov Chains Monte Carlo)&lt;/li&gt;
  &lt;li&gt;VB (Variational Bayes)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;exemplo-anlise-de-ponto-de-mudana&quot;&gt;Exemplo: Análise de ponto de mudança&lt;/h3&gt;

&lt;p&gt;Temos um banco de dados assim&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;N &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;29&lt;/span&gt;

y &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.92&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.81&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.83&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.67&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
       &lt;span class=&quot;m&quot;&gt;0.59&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.51&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.44&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.43&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.43&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.33&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.24&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;m&quot;&gt;-0.13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.33&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.46&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.43&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.65&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

x &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1.39&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1.39&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1.08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1.08&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.94&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.80&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.63&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.63&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
       &lt;span class=&quot;m&quot;&gt;-0.12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.34&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.34&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.44&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;m&quot;&gt;0.59&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.70&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.85&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.99&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;kt&quot;&gt;data_frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;%&amp;gt;%&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Queremos ajustar no gráfico um modelo linear de ponto de mudança, que vai ajustar duas retas, uma antes e outra depois de certo ponto. O ponto de mudança é determinado pelo modelo.&lt;/p&gt;

&lt;h4 id=&quot;dados&quot;&gt;Dados&lt;/h4&gt;

&lt;p&gt;No LD, dados não são especificados em um &lt;code&gt;data.frame&lt;/code&gt;. Ao invés disso, temos de criar uma lista contendo, além dos dados, algumas informações iniciais, como&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mon.names &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;LP&amp;quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# variáveis para monitoramento. No caso, Log Posterior&lt;/span&gt;
parm.names &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; as.parm.names&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; beta&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; sigma&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; theta&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# nomes dos parâmetros&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;as.parm.names&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pos.alpha &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;grep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;alpha&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; parm.names&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# posição do parâmetro alpha&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in grep(&amp;quot;alpha&amp;quot;, parm.names): objeto &amp;#39;parm.names&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pos.beta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;grep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;beta&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; parm.names&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# posição dos parâmetros beta&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in grep(&amp;quot;beta&amp;quot;, parm.names): objeto &amp;#39;parm.names&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pos.sigma &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;grep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;sigma&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; parm.names&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# posição do parâmetro sigma&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in grep(&amp;quot;sigma&amp;quot;, parm.names): objeto &amp;#39;parm.names&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pos.theta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;grep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;theta&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; parm.names&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# posição do parâmetro theta&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in grep(&amp;quot;theta&amp;quot;, parm.names): objeto &amp;#39;parm.names&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Função que gera valores iniciais para os parâmetros. No caso, sem muito critério.&lt;/span&gt;
PGF &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Data&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; runif&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; runif&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;

MyData &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;N&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;N&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               PGF&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;PGF&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               mon.names&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mon.names&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               parm.names&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;parm.names&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
               pos.alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pos.alpha&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               pos.beta&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pos.beta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               pos.sigma&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pos.sigma&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
               pos.theta&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;pos.theta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
               y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;parm.names&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;modelo&quot;&gt;Modelo&lt;/h4&gt;

&lt;p&gt;No LD precisamos espeficiar uma função &lt;code&gt;Model&lt;/code&gt; que será responsável por calcular as informações necessárias para atualização do modelo.&lt;/p&gt;

&lt;p&gt;A função recebe um vetor numérico de parâmetros, e a lista com os dados, e retorna uma lista contendo a &lt;code&gt;LP&lt;/code&gt; (log posteriori sem normalização) calculada, o &lt;code&gt;Dev&lt;/code&gt; (deviance), as informações monitoradas (no caso, LP), um &lt;code&gt;yhat&lt;/code&gt; (chute para o valor de y, de acordo com os parâmetros calculados), e &lt;code&gt;parm&lt;/code&gt; o vetor de parâmetros (usualmente ajustado para ficar dentro do espaço paramétrico).&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;Model &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;parm&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Data&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;### Parameters&lt;/span&gt;
  alpha &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; parm&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;Data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;pos.alpha&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  beta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; parm&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;Data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;pos.beta&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  sigma &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; interval&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;parm&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;Data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;pos.sigma&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1e-100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;Inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  parm&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;Data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;pos.sigma&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sigma &lt;span class=&quot;c1&quot;&gt;# atualiza o valor para retornar depois&lt;/span&gt;
  theta &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; interval&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;parm&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;Data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;pos.theta&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  parm&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;Data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;pos.theta&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; theta &lt;span class=&quot;c1&quot;&gt;# atualiza o valor para retornar depois&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;### Log-Prior (calcula com base nas funções das prioris predefinidas)&lt;/span&gt;
  alpha.prior &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; dnormv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;alpha&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; log&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  beta.prior &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dnormv&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; log&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  sigma.prior &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; dhalfcauchy&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sigma&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; log&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  theta.prior &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; dunif&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-1.3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; log&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;### Log-Likelihood (calcula a log-verossimilhança com base no modelo concebido)&lt;/span&gt;
  mu &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;beta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; theta&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; theta&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  LL &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Data&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mu&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; sigma&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; log&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
  
  &lt;span class=&quot;c1&quot;&gt;### Log-Posterior (calcula a log posteriori)&lt;/span&gt;
  LP &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; LL &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; alpha.prior &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; beta.prior &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; sigma.prior &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; theta.prior
  
  Modelout &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;LP&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LP&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                   Dev&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;LL&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                   Monitor&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;LP&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                   yhat&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;rnorm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mu&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; mu&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; sigma&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                   parm&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;parm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
  &lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Modelout&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;atualizao-ajuste&quot;&gt;Atualização (“ajuste”)&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reprodutibilidade&lt;/span&gt;

Initial.Values &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;-0.6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.02&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.04&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# valores iniciais da cadeia&lt;/span&gt;

Fit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; LaplacesDemon&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Model&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; MyData&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Initial.Values&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     Iterations &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                     Status &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     Thinning &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     Algorithm&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;HARM&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;LaplacesDemon&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Fit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in print(Fit): objeto &amp;#39;Fit&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;Consort&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Fit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;Consort&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id=&quot;plotando-resultado&quot;&gt;Plotando resultado&lt;/h4&gt;

&lt;p&gt;Diagnóstico&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Fit&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; BurnIn&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; MyData&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; PDF&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Parms&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(Fit, BurnIn = 1e+05, MyData, PDF = FALSE, Parms = NULL): objeto &amp;#39;Fit&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Resultados&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;caterpillar.plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Fit&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Parms&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;beta&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;theta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;caterpillar.plot&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Valores preditos&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;Pred &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; predict&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Fit&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Model&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; MyData&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in predict(Fit, Model, MyData): objeto &amp;#39;Fit&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Pred&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; Style&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Fitted&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(Pred, Style = &amp;quot;Fitted&amp;quot;): objeto &amp;#39;Pred&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Um gráfico muito difícil para frequentistas&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;m &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; Fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;Posterior2 &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; summarise_each&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;funs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;median&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;%&amp;gt;%&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kt&quot;&gt;data_frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_segment&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; xend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
               yend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_segment&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; xend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
               yend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.2.&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; theta&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
             data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;Posterior2&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; alpha&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.05&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
             colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;%&amp;gt;%&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kt&quot;&gt;data_frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; 
  ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;x&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;y&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_segment&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; xend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-1.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
               yend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_segment&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; xend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
               yend&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;beta.2.&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1.2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;m&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_density2d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;theta&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;alpha &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; beta.1. &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; theta&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
             data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Fit&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;Posterior2&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
             colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_x_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;limits&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  scale_y_continuous&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;limits&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.75&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;%&amp;gt;%&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;sobre-redes-neurais&quot;&gt;Sobre redes neurais&lt;/h2&gt;

&lt;p&gt;Exemplo retirado &lt;a href=&quot;http://gekkoquant.com/2012/05/26/neural-networks-with-r-simple-example/&quot;&gt;deste site&lt;/a&gt; e levemente modificado.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;neuralnet&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(neuralnet): there is no package called &amp;#39;neuralnet&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;trainningdata &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data_frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Input&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;runif&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; min&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; max&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; Output&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Input&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;data_frame&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Train the neural network&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Going to have 10 hidden layers&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Threshold is a numeric value specifying the threshold for the partial&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# derivatives of the error function as stopping criteria.&lt;/span&gt;

net.sqrt &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; neuralnet&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Output &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; Input&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; trainingdata&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; hidden&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; threshold&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;neuralnet&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;net.sqrt&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in print(net.sqrt): objeto &amp;#39;net.sqrt&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;net.sqrt&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(net.sqrt): objeto &amp;#39;net.sqrt&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;testdata &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;test&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
net.results &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; compute&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;net.sqrt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; testdata&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;compute&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;cleanoutput &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data_frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;testdata&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;test&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                          real_resp&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; 
                          estimate&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;as.vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;net.results&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;net.result&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;data_frame&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cleanoutput&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in print(cleanoutput): objeto &amp;#39;cleanoutput&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1 id=&quot;parte-2-big-data&quot;&gt;Parte 2: “Big data”&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/slides/aula_08_apresentacao.html&quot;&gt;nos slides&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/criar-instancia-amazon-ec2.html&quot;&gt;um tutorial&lt;/a&gt; para criar uma instância com RStudio instalado na Amazon AWS.&lt;/p&gt;

&lt;h1 id=&quot;parte-3-htmlwidgets&quot;&gt;Parte 3: htmlwidgets&lt;/h1&gt;

&lt;p&gt;Acesse o &lt;a href=&quot;http://www.htmlwidgets.org/&quot;&gt;site&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;extra-web-crawling&quot;&gt;Extra: web crawling&lt;/h1&gt;

&lt;p&gt;Ver &lt;a href=&quot;https://github.com/jtrecenti/sabesp&quot;&gt;este repositório&lt;/a&gt; que baixa os dados da sabesp. Estudar pacotes &lt;code&gt;RCurl&lt;/code&gt; (Duncan), XML (Duncan), &lt;code&gt;httr&lt;/code&gt; (Hadley) e &lt;code&gt;rvest&lt;/code&gt; (Hadley).&lt;/p&gt;

</description>
        <pubDate>Wed, 04 Feb 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula08/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula08/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 07 - Modelando</title>
        <description>&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/slides/aula_07_apresentacao.html&quot; target=&quot;_blank&quot;&gt;Slides dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/script/aula_07.R&quot; target=&quot;_blank&quot;&gt;Script dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(pander): there is no package called &amp;#39;pander&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;panderOptions&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1 id=&quot;regresso-linear-e-anova&quot;&gt;Regressão Linear e ANOVA&lt;/h1&gt;

&lt;p&gt;O R tem todo o ferramentário necessário para fazer modelos lineares, a começar pelo modelo de regressão linear normal.&lt;/p&gt;

&lt;p&gt;Para ilustrar, vamos utilizar a base de dados &lt;code&gt;mtcars&lt;/code&gt; que vem no R.&lt;/p&gt;

&lt;p&gt;Cada uma das 32 linhas da base &lt;code&gt;mtcars&lt;/code&gt; representa um carro. A variável &lt;code&gt;mpg&lt;/code&gt; é o consumo de combustível em milhas por galão (~3.76 Litros) e iremos tentar explicá-la pelas demais características dos veículos.&lt;/p&gt;

&lt;h2 id=&quot;um-pouco-de-descritiva&quot;&gt;Um pouco de descritiva&lt;/h2&gt;

&lt;h3 id=&quot;univariada&quot;&gt;Univariada&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# os dados&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# banco de dados das variáveis contínuas no formato &amp;quot;longo&amp;quot;&lt;/span&gt;
mtcars_long &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mtcars &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;  
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; disp&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;qsec&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  gather&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;var_continuas&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 

&lt;span class=&quot;c1&quot;&gt;# medidas resumo para variáveis contínuas&lt;/span&gt;
mtcars_long &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;var_continuas&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  summarise&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;N&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Missing&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;is.na&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Media&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;DesvPad&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; sd&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Minimo&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Q1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; quantile&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Mediana&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; quantile&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Q3&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; quantile&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.75&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Maximo&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate_each&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;funs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;var_continuas&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Source: local data frame [6 x 10]
## 
##   var_continuas     N Missing Media DesvPad Minimo    Q1 Mediana
##          (fctr) (dbl)   (dbl) (dbl)   (dbl)  (dbl) (dbl)   (dbl)
## 1           mpg    32       0  20.1     6.0   10.4  15.4    19.2
## 2          disp    32       0 230.7   123.9   71.1 120.8   196.3
## 3            hp    32       0 146.7    68.6   52.0  96.5   123.0
## 4          drat    32       0   3.6     0.5    2.8   3.1     3.7
## 5            wt    32       0   3.2     1.0    1.5   2.6     3.3
## 6          qsec    32       0  17.8     1.8   14.5  16.9    17.7
## Variables not shown: Q3 (dbl), Maximo (dbl)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# boxplots&lt;/span&gt;
mtcars_long &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_boxplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_wrap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;var_continuas&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scales &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-2-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-2&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# frequencias de variáveis categóricas&lt;/span&gt;
mtcars_freq &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; mtcars &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; vs&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;carb&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  gather&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;vars_categoricas&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  rename&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;categoria &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; value&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;vars_categoricas&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; categoria&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  summarise&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;freq &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;vars_categoricas&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;prop &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; freq&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;freq&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
         prop_txt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;prop&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;paste0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;%&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

mtcars_freq&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Source: local data frame [16 x 5]
## Groups: vars_categoricas [5]
## 
##    vars_categoricas categoria  freq    prop prop_txt
##              (fctr)     (dbl) (int)   (dbl)    (chr)
## 1               cyl         4    11 0.34375      34%
## 2               cyl         6     7 0.21875      22%
## 3               cyl         8    14 0.43750      44%
## 4                vs         0    18 0.56250      56%
## 5                vs         1    14 0.43750      44%
## 6                am         0    19 0.59375      59%
## 7                am         1    13 0.40625      41%
## 8              gear         3    15 0.46875      47%
## 9              gear         4    12 0.37500      38%
## 10             gear         5     5 0.15625      16%
## 11             carb         1     7 0.21875      22%
## 12             carb         2    10 0.31250      31%
## 13             carb         3     3 0.09375       9%
## 14             carb         4    10 0.31250      31%
## 15             carb         6     1 0.03125       3%
## 16             carb         8     1 0.03125       3%&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Gráfico de barras&lt;/span&gt;
mtcars_freq &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_bar&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;categoria&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; freq&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; position &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;dodge&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; stat &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;identity&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  facet_wrap&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;vars_categoricas&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; scales&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;free&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-2-2.png&quot; alt=&quot;plot of chunk unnamed-chunk-2&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;versus-mpg&quot;&gt;Versus &lt;code&gt;mpg&lt;/code&gt;&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Matriz de correlação linear&lt;/span&gt;
mtcars &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;  
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; disp&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;qsec&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  cor &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  &lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##        mpg  disp    hp  drat    wt  qsec
## mpg   1.00 -0.85 -0.78  0.68 -0.87  0.42
## disp -0.85  1.00  0.79 -0.71  0.89 -0.43
## hp   -0.78  0.79  1.00 -0.45  0.66 -0.71
## drat  0.68 -0.71 -0.45  1.00 -0.71  0.09
## wt   -0.87  0.89  0.66 -0.71  1.00 -0.17
## qsec  0.42 -0.43 -0.71  0.09 -0.17  1.00&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Matriz de dispersão&lt;/span&gt;
pairs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;  
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; disp&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;qsec&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-3-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-3&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;regresso-linear&quot;&gt;Regressão linear&lt;/h2&gt;
&lt;p&gt;A função que ajusta modelo linear normal no R é &lt;code&gt;lm()&lt;/code&gt;. Você especifica o banco de dados e a fórmula com as variáveis que você deseja associar.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;resposta &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; explicativas&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; meus_dados&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;O objeto &lt;code&gt;ajuste&lt;/code&gt; contém todos os resultados e com a ajuda de alguns comandos, você extrai tudo o que é interessante.&lt;/p&gt;

&lt;p&gt;Exemplo:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste_lm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

ajuste_lm&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = mpg ~ wt, data = mtcars)
## 
## Coefficients:
## (Intercept)           wt  
##      37.285       -5.344&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;No código acima temos &lt;code&gt;mpg&lt;/code&gt; explicado por &lt;code&gt;wt&lt;/code&gt;. A saída do &lt;code&gt;lm()&lt;/code&gt; mostra qual foi a chamada do modelo e os coeficientes ajustados. Como visto na análise descritiva, há uma clara associação linear e negativa entre as variáveis, justificando o parâmetro negativo &lt;code&gt;wt = -5.344&lt;/code&gt;. A função &lt;code&gt;coeficients()&lt;/code&gt; ou &lt;code&gt;coef()&lt;/code&gt; nos fornece os coeficientes ajustados.&lt;/p&gt;

&lt;p&gt;Gráfico da reta ajustada:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# extrai os coeficientes ajustados&lt;/span&gt;
coeficientes &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; coef&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_abline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;intercept &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; coeficientes&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; slope &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; coeficientes&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-6-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-6&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;summary()&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;A função &lt;code&gt;summary()&lt;/code&gt; é uma função genérica que geralmente devolve um resumo de informações úteis de praticamente qualquer classe de objetos. Para objetos &lt;code&gt;lm()&lt;/code&gt; ela devolve:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Chamada do modelo&lt;/li&gt;
  &lt;li&gt;Medidas resumo dos resíduos&lt;/li&gt;
  &lt;li&gt;Tabela de coeficientes, desvios padrão e testes T para hipótese nula de parâmetros iguais a zero.&lt;/li&gt;
  &lt;li&gt;Média dos quadrados do resíduo e os respectivos graus de liberdade; $R^2$ e $R^2$ ajustado da regressão; Estatística F para qualidade do ajuste (comparação com o modelo com apenas o intercepto).&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;assets/fig/summary_lm.png&quot; alt=&quot;summary lm&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;plot()&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;A função &lt;code&gt;plot()&lt;/code&gt; constrói gráficos úteis para diagnóstico do modelo.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# opção para mostrar 4 gráficos em uma mesma figura&lt;/span&gt;
par&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mfrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# gráficos de diagnóstico do modelo ajuste_lm&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-8-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-8&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# retorna ao normal&lt;/span&gt;
par&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mfrow &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;anova()&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Uma parte importante da modelagem é a redução de modelos. A função &lt;code&gt;anova()&lt;/code&gt; compara dois (ou mais) modelos encaixados por meio da estatística F (por padrão), especialmente indicadas para modelos lineares normais. Caso seja passada apenas um ajuste à função, ela devolve a tabela de ANOVA (termos testados sequencialmente).&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# modelo nulo, com apenas o intercepto&lt;/span&gt;
ajuste_lm_nulo &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# modelo com wt e cyl&lt;/span&gt;
ajuste_lm2 &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; wt &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# compara o modelo com wt com o modelo nulo&lt;/span&gt;
anova&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm_nulo&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ajuste_lm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Analysis of Variance Table
## 
## Model 1: mpg ~ 1
## Model 2: mpg ~ wt
##   Res.Df     RSS Df Sum of Sq      F    Pr(&amp;gt;F)    
## 1     31 1126.05                                  
## 2     30  278.32  1    847.73 91.375 1.294e-10 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Tabela de ANOVA, testa os termos sequencialmente&lt;/span&gt;
anova&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Analysis of Variance Table
## 
## Response: mpg
##             Df Sum Sq Mean Sq  F value    Pr(&amp;gt;F)    
## wt           1 847.73  847.73 129.6650 5.079e-12 ***
## factor(cyl)  2  95.26   47.63   7.2856  0.002835 ** 
## Residuals   28 183.06    6.54                       
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;A o valor-p = 0.001064 indica que o modelo com &lt;code&gt;wt + cyl&lt;/code&gt; trás melhorias significantes no poder explicativo do modelo quando comparado ao modelo com apenas &lt;code&gt;wt&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;demais comandos&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Outros comandos úteis são:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in function_list[[k]](value): não foi possível encontrar a função &amp;quot;pander&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;frmulas&quot;&gt;Fórmulas&lt;/h2&gt;

&lt;p&gt;Objetos de classe &lt;code&gt;formula&lt;/code&gt; possuem sintaxe muito conveniente para especificar o modelo estatístico que desejamos ajustar. O símbolo que define esses objetos é o &lt;code&gt;~&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Estrutura:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;resposta &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; explicativas&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Então se o objetivo fosse ajustar o modelo&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Y_i = \beta_0 + \beta_1X_i + \epsilon_i,&lt;/script&gt;

&lt;p&gt;passaríamos ao R a seguinte fórmula&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para incorporar mais variáveis usamos o símbolo &lt;code&gt;+&lt;/code&gt;. O modelo&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Y_i = \beta_0 + \beta_1X_i + \beta_2Z_i + \epsilon_i,&lt;/script&gt;

&lt;p&gt;ficaria traduzido como&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; Z&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Utilizamos o símbolo &lt;code&gt;*&lt;/code&gt; para introduzir os componentes de interação, além dos componentes aditivos.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; Z&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Teoricamente teríamos, para Z &lt;strong&gt;contínua&lt;/strong&gt;, o modelo de regressão&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Y_i = \beta_0 + \beta_1X_i + \beta_2Z_i + \beta_3X_i*Z_i + \epsilon_i,&lt;/script&gt;

&lt;p&gt;Ou, para Z &lt;strong&gt;categórica&lt;/strong&gt;, o modelo de ANCOVA&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Y_{ij} = \alpha_j + \beta_jX_{ij} + \epsilon_{ij},&lt;/script&gt;

&lt;p&gt;O operador &lt;code&gt;:&lt;/code&gt; faz com que apenas o componente de interação seja incluído no modelo. Para ilustrar, observe que o modelo&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; Z&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é a mesma coisa que&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; Z &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; X&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;Z&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Os operadores aritméticos exercem função diferente em fórmulas. O sinal de &lt;code&gt;+&lt;/code&gt; no exemplo induziu em um modelo aditivo em vez de somar X com Z. Para fazer com que eles assumam seus significados aritméticos temos que utilizar a função &lt;code&gt;I()&lt;/code&gt;. Exemplo:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; Z&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Agora sim o componente &lt;code&gt;I(X + Z)&lt;/code&gt; representa a soma de X com Z. Outros exemplos: &lt;code&gt;I(X^2)&lt;/code&gt;, &lt;code&gt;I(log(X + 1))&lt;/code&gt;, &lt;code&gt;I(sqrt(X+Z*5))&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Tabela de simbolos para utilizar em fórmulas&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in function_list[[k]](value): não foi possível encontrar a função &amp;quot;pander&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;seleo-de-variveis&quot;&gt;Seleção de variáveis&lt;/h2&gt;

&lt;h3 id=&quot;linearhypothesis&quot;&gt;linearHypothesis&lt;/h3&gt;

&lt;p&gt;Frequentemente temos interesse em saber se parâmetros são diferentes de zero ou se são diferentes entre si. Para isto, costumamos efetuar testes do tipo Wald para combinações lineares dos parâmetros.&lt;/p&gt;

&lt;p&gt;Para este fim, a função &lt;code&gt;linearHypothesis()&lt;/code&gt; do pacote &lt;code&gt;car&lt;/code&gt; faz o trabalho.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;car&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(car): there is no package called &amp;#39;car&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;linearHypothesis&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;linearHypothesis&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;stepwise&quot;&gt;stepwise&lt;/h3&gt;

&lt;p&gt;Stepwise no R se faz com as funções &lt;code&gt;step()&lt;/code&gt; do pacote &lt;code&gt;stats&lt;/code&gt; ou &lt;code&gt;stepAIC()&lt;/code&gt; do pacote &lt;code&gt;MASS&lt;/code&gt;. Escolher entre &lt;code&gt;forward&lt;/code&gt;, &lt;code&gt;backward&lt;/code&gt; ou &lt;code&gt;both&lt;/code&gt; (ambos) basta passar um desses nomes ao parâmetro &lt;code&gt;direction&lt;/code&gt; da função.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# modelo aditivo completo&lt;/span&gt;
ajuste_lm_completo &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mpg &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# modelo forward&lt;/span&gt;
step&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm_completo&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; direction &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;forward&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Start:  AIC=70.9
## mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = mpg ~ cyl + disp + hp + drat + wt + qsec + vs + 
##     am + gear + carb, data = mtcars)
## 
## Coefficients:
## (Intercept)          cyl         disp           hp         drat  
##    12.30337     -0.11144      0.01334     -0.02148      0.78711  
##          wt         qsec           vs           am         gear  
##    -3.71530      0.82104      0.31776      2.52023      0.65541  
##        carb  
##    -0.19942&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# modelo backward&lt;/span&gt;
step&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm_completo&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; direction &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;backward&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Start:  AIC=70.9
## mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - cyl   1    0.0799 147.57 68.915
## - vs    1    0.1601 147.66 68.932
## - carb  1    0.4067 147.90 68.986
## - gear  1    1.3531 148.85 69.190
## - drat  1    1.6270 149.12 69.249
## - disp  1    3.9167 151.41 69.736
## - hp    1    6.8399 154.33 70.348
## - qsec  1    8.8641 156.36 70.765
## &amp;lt;none&amp;gt;              147.49 70.898
## - am    1   10.5467 158.04 71.108
## - wt    1   27.0144 174.51 74.280
## 
## Step:  AIC=68.92
## mpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - vs    1    0.2685 147.84 66.973
## - carb  1    0.5201 148.09 67.028
## - gear  1    1.8211 149.40 67.308
## - drat  1    1.9826 149.56 67.342
## - disp  1    3.9009 151.47 67.750
## - hp    1    7.3632 154.94 68.473
## &amp;lt;none&amp;gt;              147.57 68.915
## - qsec  1   10.0933 157.67 69.032
## - am    1   11.8359 159.41 69.384
## - wt    1   27.0280 174.60 72.297
## 
## Step:  AIC=66.97
## mpg ~ disp + hp + drat + wt + qsec + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - carb  1    0.6855 148.53 65.121
## - gear  1    2.1437 149.99 65.434
## - drat  1    2.2139 150.06 65.449
## - disp  1    3.6467 151.49 65.753
## - hp    1    7.1060 154.95 66.475
## &amp;lt;none&amp;gt;              147.84 66.973
## - am    1   11.5694 159.41 67.384
## - qsec  1   15.6830 163.53 68.200
## - wt    1   27.3799 175.22 70.410
## 
## Step:  AIC=65.12
## mpg ~ disp + hp + drat + wt + qsec + am + gear
## 
##        Df Sum of Sq    RSS    AIC
## - gear  1     1.565 150.09 63.457
## - drat  1     1.932 150.46 63.535
## &amp;lt;none&amp;gt;              148.53 65.121
## - disp  1    10.110 158.64 65.229
## - am    1    12.323 160.85 65.672
## - hp    1    14.826 163.35 66.166
## - qsec  1    26.408 174.94 68.358
## - wt    1    69.127 217.66 75.350
## 
## Step:  AIC=63.46
## mpg ~ disp + hp + drat + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - drat  1     3.345 153.44 62.162
## - disp  1     8.545 158.64 63.229
## &amp;lt;none&amp;gt;              150.09 63.457
## - hp    1    13.285 163.38 64.171
## - am    1    20.036 170.13 65.466
## - qsec  1    25.574 175.67 66.491
## - wt    1    67.572 217.66 73.351
## 
## Step:  AIC=62.16
## mpg ~ disp + hp + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - disp  1     6.629 160.07 61.515
## &amp;lt;none&amp;gt;              153.44 62.162
## - hp    1    12.572 166.01 62.682
## - qsec  1    26.470 179.91 65.255
## - am    1    32.198 185.63 66.258
## - wt    1    69.043 222.48 72.051
## 
## Step:  AIC=61.52
## mpg ~ hp + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - hp    1     9.219 169.29 61.307
## &amp;lt;none&amp;gt;              160.07 61.515
## - qsec  1    20.225 180.29 63.323
## - am    1    25.993 186.06 64.331
## - wt    1    78.494 238.56 72.284
## 
## Step:  AIC=61.31
## mpg ~ wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## &amp;lt;none&amp;gt;              169.29 61.307
## - am    1    26.178 195.46 63.908
## - qsec  1   109.034 278.32 75.217
## - wt    1   183.347 352.63 82.790&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Coefficients:
## (Intercept)           wt         qsec           am  
##       9.618       -3.917        1.226        2.936&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# modelo both&lt;/span&gt;
step&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_lm_completo&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; direction &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;both&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Start:  AIC=70.9
## mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - cyl   1    0.0799 147.57 68.915
## - vs    1    0.1601 147.66 68.932
## - carb  1    0.4067 147.90 68.986
## - gear  1    1.3531 148.85 69.190
## - drat  1    1.6270 149.12 69.249
## - disp  1    3.9167 151.41 69.736
## - hp    1    6.8399 154.33 70.348
## - qsec  1    8.8641 156.36 70.765
## &amp;lt;none&amp;gt;              147.49 70.898
## - am    1   10.5467 158.04 71.108
## - wt    1   27.0144 174.51 74.280
## 
## Step:  AIC=68.92
## mpg ~ disp + hp + drat + wt + qsec + vs + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - vs    1    0.2685 147.84 66.973
## - carb  1    0.5201 148.09 67.028
## - gear  1    1.8211 149.40 67.308
## - drat  1    1.9826 149.56 67.342
## - disp  1    3.9009 151.47 67.750
## - hp    1    7.3632 154.94 68.473
## &amp;lt;none&amp;gt;              147.57 68.915
## - qsec  1   10.0933 157.67 69.032
## - am    1   11.8359 159.41 69.384
## + cyl   1    0.0799 147.49 70.898
## - wt    1   27.0280 174.60 72.297
## 
## Step:  AIC=66.97
## mpg ~ disp + hp + drat + wt + qsec + am + gear + carb
## 
##        Df Sum of Sq    RSS    AIC
## - carb  1    0.6855 148.53 65.121
## - gear  1    2.1437 149.99 65.434
## - drat  1    2.2139 150.06 65.449
## - disp  1    3.6467 151.49 65.753
## - hp    1    7.1060 154.95 66.475
## &amp;lt;none&amp;gt;              147.84 66.973
## - am    1   11.5694 159.41 67.384
## - qsec  1   15.6830 163.53 68.200
## + vs    1    0.2685 147.57 68.915
## + cyl   1    0.1883 147.66 68.932
## - wt    1   27.3799 175.22 70.410
## 
## Step:  AIC=65.12
## mpg ~ disp + hp + drat + wt + qsec + am + gear
## 
##        Df Sum of Sq    RSS    AIC
## - gear  1     1.565 150.09 63.457
## - drat  1     1.932 150.46 63.535
## &amp;lt;none&amp;gt;              148.53 65.121
## - disp  1    10.110 158.64 65.229
## - am    1    12.323 160.85 65.672
## - hp    1    14.826 163.35 66.166
## + carb  1     0.685 147.84 66.973
## + vs    1     0.434 148.09 67.028
## + cyl   1     0.414 148.11 67.032
## - qsec  1    26.408 174.94 68.358
## - wt    1    69.127 217.66 75.350
## 
## Step:  AIC=63.46
## mpg ~ disp + hp + drat + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - drat  1     3.345 153.44 62.162
## - disp  1     8.545 158.64 63.229
## &amp;lt;none&amp;gt;              150.09 63.457
## - hp    1    13.285 163.38 64.171
## + gear  1     1.565 148.53 65.121
## + cyl   1     1.003 149.09 65.242
## + vs    1     0.645 149.45 65.319
## + carb  1     0.107 149.99 65.434
## - am    1    20.036 170.13 65.466
## - qsec  1    25.574 175.67 66.491
## - wt    1    67.572 217.66 73.351
## 
## Step:  AIC=62.16
## mpg ~ disp + hp + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - disp  1     6.629 160.07 61.515
## &amp;lt;none&amp;gt;              153.44 62.162
## - hp    1    12.572 166.01 62.682
## + drat  1     3.345 150.09 63.457
## + gear  1     2.977 150.46 63.535
## + cyl   1     2.447 150.99 63.648
## + vs    1     1.121 152.32 63.927
## + carb  1     0.011 153.43 64.160
## - qsec  1    26.470 179.91 65.255
## - am    1    32.198 185.63 66.258
## - wt    1    69.043 222.48 72.051
## 
## Step:  AIC=61.52
## mpg ~ hp + wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## - hp    1     9.219 169.29 61.307
## &amp;lt;none&amp;gt;              160.07 61.515
## + disp  1     6.629 153.44 62.162
## + carb  1     3.227 156.84 62.864
## + drat  1     1.428 158.64 63.229
## - qsec  1    20.225 180.29 63.323
## + cyl   1     0.249 159.82 63.465
## + vs    1     0.249 159.82 63.466
## + gear  1     0.171 159.90 63.481
## - am    1    25.993 186.06 64.331
## - wt    1    78.494 238.56 72.284
## 
## Step:  AIC=61.31
## mpg ~ wt + qsec + am
## 
##        Df Sum of Sq    RSS    AIC
## &amp;lt;none&amp;gt;              169.29 61.307
## + hp    1     9.219 160.07 61.515
## + carb  1     8.036 161.25 61.751
## + disp  1     3.276 166.01 62.682
## + cyl   1     1.501 167.78 63.022
## + drat  1     1.400 167.89 63.042
## + gear  1     0.123 169.16 63.284
## + vs    1     0.000 169.29 63.307
## - am    1    26.178 195.46 63.908
## - qsec  1   109.034 278.32 75.217
## - wt    1   183.347 352.63 82.790&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## lm(formula = mpg ~ wt + qsec + am, data = mtcars)
## 
## Coefficients:
## (Intercept)           wt         qsec           am  
##       9.618       -3.917        1.226        2.936&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr /&gt;
&lt;p&gt;## Regressão Linear Generalizada&lt;/p&gt;

&lt;p&gt;A regressão linear normal pode ser inadequada quando a distribuição de $Y_i$ é assimétrica, representa
dados de contagens ou então dados binários. Para lidar com esse problema, McCulagh e Nelder estenderam
a família de distribuições para ajuste da regressão para distribuições da &lt;em&gt;família exponencial&lt;/em&gt;. Tal
família inclui as distribuições &lt;code&gt;normal&lt;/code&gt;, &lt;code&gt;poisson&lt;/code&gt;, &lt;code&gt;gama&lt;/code&gt;, &lt;code&gt;normal inversa&lt;/code&gt; e &lt;code&gt;binomial&lt;/code&gt; (incluindo
&lt;code&gt;bernoulli&lt;/code&gt;), entre outras. Também existe uma forma de adaptar os MLG para a distribuição &lt;code&gt;binomial negativa&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;A definição dos MLG é dada por&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;Y_i \sim F(\mu_i, \phi)&lt;/script&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;\mu_i = g^{-1}(\alpha + \beta_1 x_{i1} + \beta_p x_{ip})&lt;/script&gt;

&lt;p&gt;O parâmetro $\phi$ é o parâmetro de precisão (inverso do parâmetro de dispersão) e $g$ é a &lt;em&gt;função de ligação&lt;/em&gt;, que geralmente tem o papel de jogar o intervalo de vação de $\mu_i$ (espaço paramétrico) no intervalo $(-\inf, \inf)$.&lt;/p&gt;

&lt;p&gt;Para ajustar um modelo linear generalizado, basta utilizar a função &lt;code&gt;glm&lt;/code&gt; e informar, além da fórmula, a família de distribuições da resposta.&lt;/p&gt;

&lt;h3 id=&quot;famlias-de-distribuies&quot;&gt;Famílias de distribuições&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in function_list[[k]](value): não foi possível encontrar a função &amp;quot;pander&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;ajuste-do-modelo&quot;&gt;Ajuste do modelo&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste_glm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;resposta &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; explicativas&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; dados&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; distribuicao&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para ver a lista de distribuições que podem ser passadas ao parâmetro &lt;code&gt;family&lt;/code&gt;, rode &lt;code&gt;?family&lt;/code&gt; no R.&lt;/p&gt;

&lt;p&gt;Outro componente importante em modelos lineares generalizados é a função de ligação. De modo mais geral, o código para ajsutar um MLG fica assim:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste_glm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;resposta &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; explicativas&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; dados&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; distribuicao&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;link &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; funcao_de_ligacao&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Repare que agora existe a parte &lt;code&gt;(link = funcao_de_ligacao)&lt;/code&gt; depois do nome da distribuição escolhida. É comum trocar a ligação &lt;code&gt;inversa&lt;/code&gt; de uma regressão Gama para uma ligação &lt;code&gt;log&lt;/code&gt;, por exemplo. Em R, ficaria:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste_gama &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Y &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; X &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;X&lt;span class=&quot;o&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; Z&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; dados&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Gamma&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;link &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;log&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Todas as funções úteis para &lt;code&gt;lm()&lt;/code&gt; continuam sendo úteis para &lt;code&gt;glm()&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;exemplo-regresso-logstica&quot;&gt;Exemplo: Regressão logística&lt;/h3&gt;

&lt;p&gt;A regressão logística se caracteriza por assumir distribuição binomial à variável resposta. Para exemplificar um ajuste de regressão logística, vamos aproveitar o mesmo banco &lt;code&gt;mtcars&lt;/code&gt;, mas agora vamos modelar &lt;code&gt;am&lt;/code&gt; em vez de &lt;code&gt;mpg&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;breve-descritiva&quot;&gt;Breve descritiva&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;mtcars &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  summarise&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;N&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; n&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Missing&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;is.na&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Media&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;DesvPad&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; sd&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Minimo&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Q1&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; quantile&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Mediana&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; quantile&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Q3&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; quantile&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.75&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;s&quot;&gt;&amp;quot;Maximo&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate_each&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;funs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Source: local data frame [2 x 10]
## 
##      am     N Missing Media DesvPad Minimo    Q1 Mediana    Q3 Maximo
##   (dbl) (dbl)   (dbl) (dbl)   (dbl)  (dbl) (dbl)   (dbl) (dbl)  (dbl)
## 1     0    19       0   3.8     0.8    2.5   3.4     3.5   3.8    5.4
## 2     1    13       0   2.4     0.6    1.5   1.9     2.3   2.8    3.6&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_boxplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-25-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-25&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;ajuste&quot;&gt;Ajuste&lt;/h4&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Ligação logit&lt;/span&gt;
ajuste_glm &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;am &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; binomial&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_glm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## glm(formula = am ~ wt, family = binomial, data = mtcars)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.11400  -0.53738  -0.08811   0.26055   2.19931  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&amp;gt;|z|)   
## (Intercept)   12.040      4.510   2.670  0.00759 **
## wt            -4.024      1.436  -2.801  0.00509 **
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.230  on 31  degrees of freedom
## Residual deviance: 19.176  on 30  degrees of freedom
## AIC: 23.176
## 
## Number of Fisher Scoring iterations: 6&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; predict&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_glm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    
##     FALSE TRUE
##   0    18    1
##   1     3   10&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Por padrão, a função de ligação da distribuição &lt;code&gt;binomial&lt;/code&gt; é a &lt;code&gt;logit&lt;/code&gt;. Se quisermos usar a função &lt;code&gt;probit&lt;/code&gt;, precisamos especificar isto no parâmetro &lt;code&gt;family&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Ligaçao probit&lt;/span&gt;
ajuste_glm_probit &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; glm&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;am &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; binomial&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;link &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;probit&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_glm_probit&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## glm(formula = am ~ wt, family = binomial(link = &amp;quot;probit&amp;quot;), data = mtcars)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.04796  -0.55217  -0.05909   0.25290   2.18880  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&amp;gt;|z|)   
## (Intercept)   6.7264     2.2684   2.965  0.00302 **
## wt           -2.2578     0.7197  -3.137  0.00171 **
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.230  on 31  degrees of freedom
## Residual deviance: 19.199  on 30  degrees of freedom
## AIC: 23.199
## 
## Number of Fisher Scoring iterations: 7&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Gráfico das curvas ajustadas:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  stat_smooth&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Logit&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; method&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;glm&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;binomial&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; se&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  stat_smooth&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Probit&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; method&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;glm&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;binomial&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;link &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;probit&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; se&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  stat_smooth&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Complementar Log-Log&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; method&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;glm&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; family&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;binomial&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;link &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;cloglog&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; se&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  labs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;Função de ligação&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-28-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-28&quot; /&gt;&lt;/p&gt;

&lt;p&gt;O teste Chi quadrado pode ser mais indicado para regressão logística.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;anova&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_glm&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; test&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Chisq&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Analysis of Deviance Table
## 
## Model: binomial, link: logit
## 
## Response: am
## 
## Terms added sequentially (first to last)
## 
## 
##      Df Deviance Resid. Df Resid. Dev  Pr(&amp;gt;Chi)    
## NULL                    31     43.230              
## wt    1   24.054        30     19.176 9.369e-07 ***
## ---
## Signif. codes:  0 &amp;#39;***&amp;#39; 0.001 &amp;#39;**&amp;#39; 0.01 &amp;#39;*&amp;#39; 0.05 &amp;#39;.&amp;#39; 0.1 &amp;#39; &amp;#39; 1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;anlise-de-diagnstico&quot;&gt;Análise de diagnóstico&lt;/h3&gt;

&lt;p&gt;Na página &lt;a href=&quot;http://www.ime.usp.br/~giapaula/textoregressao.htm&quot;&gt;do professor Gilberto&lt;/a&gt; pode-se obter o livro dele sobre GLM e também vários comandos para realizar análises de diagnóstico dos modelos ajustados.&lt;/p&gt;

&lt;h2 id=&quot;modelos-mistos&quot;&gt;Modelos mistos&lt;/h2&gt;

&lt;p&gt;Quando uma mesma unidade observacional é medida várias vezes em diferentes contextos, temos em mãos um problema de medidas repetidas. Em particular, quando essas medidas são realizadas ao longo do tempo, temos um problema de dados longitudinais.&lt;/p&gt;

&lt;p&gt;A dificuldade desses tipos de estudo está no fato de que, como o mesmo indivíduo é observado em vários momentos, nem sempre é razoável considerar essas medidas como independentes. Por exemplo, se estou acompanhando o crescimento da massa de ovelhas ao longo do tempo, esperamos que a ovelha mais “gordinha” tende a ser sempre a mais gordinha.&lt;/p&gt;

&lt;p&gt;Para resolver isso, geralmente impomos uma &lt;em&gt;estrutura de correlação&lt;/em&gt; para observações de um mesmo indivíduo, e uma maneira de impor essa estrutura de correlação é realizar uma análise com efeitos mistos.&lt;/p&gt;

&lt;p&gt;A grande diferença de um modelo de regressão comum e um modelo misto é que parte dos parâmetros são na verdade variáveis aleatórias. Não vamos entrar em detalhe na parte teórica, mas se quiser, dê uma lida no &lt;a href=&quot;http://www.ime.usp.br/~jmsinger/Textos/Singer&amp;amp;Nobre&amp;amp;Rocha2012mar.pdf&quot;&gt;livro do professor Singer&lt;/a&gt;, que está em andamento.&lt;/p&gt;

&lt;p&gt;Para ajustar modelos mistos geralmente utilizamos os pacotes &lt;code&gt;nlme&lt;/code&gt; e &lt;code&gt;lme4&lt;/code&gt;. O pacote &lt;code&gt;nlme&lt;/code&gt; faz algumas coisas a mais na parte de modelos não lineares, mas o pacote &lt;code&gt;lme4&lt;/code&gt; é muito melhor desenvolvido atualmente e recomendamos seu uso.&lt;/p&gt;

&lt;h3 id=&quot;exemplo-teste-t-pareado&quot;&gt;Exemplo: Teste t pareado&lt;/h3&gt;

&lt;p&gt;Geralmente utilizamos o teste t pareado quando queremos comparar médias, mas os indivíduos foram medidos em diferentes situações ou momentos.&lt;/p&gt;

&lt;p&gt;Vamos ilustrar com os seguintes dados. Na base de dados &lt;code&gt;sleep&lt;/code&gt;, temos medido o efeito de duas diferentes drogas aplicadas a 10 indivíduos (as duas drogas foram aplicadas nos 10 indivíduos) no tempo de sono. Queremos verificar se as drogas tiveram efeitos distintos.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;sleep &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;paste0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;droga_&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  spread&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; extra&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    ID droga_1 droga_2
## 1   1     0.7     1.9
## 2   2    -1.6     0.8
## 3   3    -0.2     1.1
## 4   4    -1.2     0.1
## 5   5    -0.1    -0.1
## 6   6     3.4     4.4
## 7   7     3.7     5.5
## 8   8     0.8     1.6
## 9   9     0.0     4.6
## 10 10     2.0     3.4&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;sleep &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_line&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;extra&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ID&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;extra&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; label&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ID&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  theme_bw&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-30-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-30&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Teste t pareado&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;aux &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; sleep &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;group&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;paste0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;droga_&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; group&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  spread&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;group&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; extra&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

t.test&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aux&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;droga_1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aux&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;droga_2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; paired&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;TRUE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## 	Paired t-test
## 
## data:  aux$droga_1 and aux$droga_2
## t = -4.0621, df = 9, p-value = 0.002833
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -2.4598858 -0.7001142
## sample estimates:
## mean of the differences 
##                   -1.58&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Paralelo do modelo misto&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;lme4&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(lme4): there is no package called &amp;#39;lme4&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;modelo &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; lmer&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;extra &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; group &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;ID&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sleep&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;lmer&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;modelo&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in summary(modelo): objeto &amp;#39;modelo&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;A parte &lt;code&gt;1|ID&lt;/code&gt; indica que o indivíduo é ID e que estamos incluindo um efeito aleatório para ele.&lt;/p&gt;

&lt;h1 id=&quot;rvore-de-deciso&quot;&gt;Árvore de Decisão&lt;/h1&gt;

&lt;p&gt;Outra tipo de modelo muito utilizado que também une simplicidade com eficiência é o de árvore de decisão. No R, seu ajuste é tão simples quanto ajustar um modelo de regressão e possui um conjunto de funções igualmente convenientes para extrair resultados.&lt;/p&gt;

&lt;p&gt;Vamos apresentar como ajustar árvore de decisão usando o pacote &lt;code&gt;tree&lt;/code&gt;, mas, como tudo no R, existem inúmeros pacotes e jeitos de ajustar uma árvore de decisão (ver este &lt;a href=&quot;http://statistical-research.com/a-brief-tour-of-the-trees-and-forests/?utm_source=rss&amp;amp;utm_medium=rss&amp;amp;utm_campaign=a-brief-tour-of-the-trees-and-forests&quot;&gt;link&lt;/a&gt; para uma lista interessante de alternativas).&lt;/p&gt;

&lt;h2 id=&quot;ajuste-1&quot;&gt;Ajuste&lt;/h2&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(tree): there is no package called &amp;#39;tree&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste_tree &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; tree&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;tree&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_tree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in summary(ajuste_tree): objeto &amp;#39;ajuste_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_tree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(ajuste_tree): objeto &amp;#39;ajuste_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_tree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; pretty &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in text(ajuste_tree, pretty = 0): objeto &amp;#39;ajuste_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Tabelas de observado versus predito: comparação entre os modelos logístico e árvore.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Logistico&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; predict&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_glm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Árvore&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; predict&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_tree&lt;span class=&quot;p&quot;&gt;)[,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;cross-validation&quot;&gt;Cross-validation&lt;/h2&gt;

&lt;p&gt;Árvores tendem a “super-ajustar” (&lt;em&gt;overfit&lt;/em&gt;) o modelo. Para este problema, &lt;em&gt;cross-validation&lt;/em&gt; é uma boa prática. Essa técnica consiste em reservar parte da base separada para depois ser usada como régua para o poder preditivo do modelo.&lt;/p&gt;

&lt;p&gt;Para fazer isso é muito fácil com a função &lt;code&gt;cv.tree()&lt;/code&gt;. Basta passar seu modelo ajustado para ela:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;123&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
cv_tree &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; cv.tree&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_tree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;cv.tree&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cv_tree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(cv_tree): objeto &amp;#39;cv_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;O gráfico mostra qual tamanho da árvore que apresentou o menor erro de predição. No nosso caso foi tamanho &lt;code&gt;2&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Para recuperar esse ajuste de tamanho &lt;code&gt;2&lt;/code&gt;, chamamos a função &lt;code&gt;prune.tree()&lt;/code&gt; da seguinte forma:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# seleciona a árvoore com 2 nós&lt;/span&gt;
melhor_tree &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; prune.tree&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_tree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; best &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;prune.tree&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Gráfico que representa a árvore `melhor_tree`&lt;/span&gt;
plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;melhor_tree&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(melhor_tree): objeto &amp;#39;melhor_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;melhor_tree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; pretty &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in text(melhor_tree, pretty = 0): objeto &amp;#39;melhor_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# oservado versus predito&lt;/span&gt;
&lt;span class=&quot;kp&quot;&gt;table&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; predict&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;melhor_tree&lt;span class=&quot;p&quot;&gt;)[,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in predict(melhor_tree): objeto &amp;#39;melhor_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;O modelo &lt;code&gt;melhor_tree&lt;/code&gt; coincidiu com o &lt;code&gt;ajuste_tree&lt;/code&gt; (que tinha tamanho &lt;code&gt;5&lt;/code&gt;) quanto ao seu desempenho em prever, porém é muito mais simples. De fato ele é mais simples do que qualquer modelo feito até aqui.&lt;/p&gt;

&lt;h2 id=&quot;parmetros-de-controle&quot;&gt;Parâmetros de controle&lt;/h2&gt;

&lt;p&gt;Árvores de decisão são ajustadas sob alguns critérios que às vezes precisamos reconfigurar. Por exemplo, no &lt;code&gt;ajuste_tree&lt;/code&gt; vimos que havia muito mais galhos do que o necessário. Isso se deveu a critérios de divisão/parada desregulado.&lt;/p&gt;

&lt;p&gt;No caso dos objetos &lt;code&gt;tree&lt;/code&gt;, temos dois parâmetros importantes: &lt;code&gt;split&lt;/code&gt; e &lt;code&gt;control&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;split&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;O parâmetro &lt;code&gt;split&lt;/code&gt; define qual o critério para decidir se divide o “galho” ou não. Por padrão, a função utiliza o critério “deviance”, que tem a mesma definição do MLG. Uma segunda opção seria &lt;strong&gt;Gini&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;control&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;O parâmetro &lt;code&gt;control&lt;/code&gt; recebe um objeto retornado pela função &lt;code&gt;tree.control()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Esta função permite você configurar:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;nobs&lt;/code&gt; Número de observações na base de treino. Isso será efetivo no &lt;code&gt;cv.tree()&lt;/code&gt;, quando uma base de treino e outra de teste é utilizada para calcular o erro de predição por meio de &lt;em&gt;cross-validation&lt;/em&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;mincut&lt;/code&gt; Número mínimo de observações a serem incluídas em cada nó.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;minsize&lt;/code&gt; O menor tamanho de nó permitido.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;mindev&lt;/code&gt; Fração mínima do deviance do nó raiz.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Como passar à função:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;controles &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; tree.control&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nobs &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; mincut &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;tree.control&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ajuste_tree &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; ajuste_tree &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; tree&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;~&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; control &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; controles&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;tree&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_tree&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ajuste_tree&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; pretty &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in plot(ajuste_tree): objeto &amp;#39;ajuste_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in text(ajuste_tree, pretty = 0): objeto &amp;#39;ajuste_tree&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1 id=&quot;anlise-multivariada&quot;&gt;Análise multivariada&lt;/h1&gt;

&lt;h2 id=&quot;anlise-de-agrupamento&quot;&gt;Análise de Agrupamento&lt;/h2&gt;

&lt;p&gt;Análise de agrupamento geralmente é uma ótima maneira de realizar estudos preliminares em uma base de dados, e algumas vezes pode trazer resultados muito úteis.&lt;/p&gt;

&lt;p&gt;Como o próprio nome diz, geralmente a análise de agrupamento serve para formar grupos de indivíduos a partir da comparação das suas medidas em relação à diversas variáveis. Não confunda aqui com árvores de decisão, pois nesse caso não há uma variável “resposta”.&lt;/p&gt;

&lt;p&gt;Existem dois tipos principais de análise de agrupamento: &lt;em&gt;hierárquico&lt;/em&gt; e &lt;em&gt;k-means&lt;/em&gt;.&lt;/p&gt;

&lt;h3 id=&quot;k-means&quot;&gt;K-means&lt;/h3&gt;
&lt;p&gt;No modelo k-means, selecionamos previamente o número de grupos e o modelo calcula, com base em algum critério, qual a melhor forma de alocar os indivíduos nesses grupos.&lt;/p&gt;

&lt;p&gt;Para ajustar essa análise utilizaremos a função &lt;code&gt;kmeans&lt;/code&gt; do pacote &lt;code&gt;stats&lt;/code&gt;. Existem mais pacotes que fazem essa análise no R.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;kms &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; kmeans&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; centers&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
kms&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## K-means clustering with 2 clusters of sizes 18, 14
## 
## Cluster means:
##        mpg      cyl     disp        hp     drat       wt     qsec
## 1 23.97222 4.777778 135.5389  98.05556 3.882222 2.609056 18.68611
## 2 15.10000 8.000000 353.1000 209.21429 3.229286 3.999214 16.77214
##          vs        am     gear     carb
## 1 0.7777778 0.6111111 4.000000 2.277778
## 2 0.0000000 0.1428571 3.285714 3.500000
## 
## Clustering vector:
##           Mazda RX4       Mazda RX4 Wag          Datsun 710 
##                   1                   1                   1 
##      Hornet 4 Drive   Hornet Sportabout             Valiant 
##                   1                   2                   1 
##          Duster 360           Merc 240D            Merc 230 
##                   2                   1                   1 
##            Merc 280           Merc 280C          Merc 450SE 
##                   1                   1                   2 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood 
##                   2                   2                   2 
## Lincoln Continental   Chrysler Imperial            Fiat 128 
##                   2                   2                   1 
##         Honda Civic      Toyota Corolla       Toyota Corona 
##                   1                   1                   1 
##    Dodge Challenger         AMC Javelin          Camaro Z28 
##                   2                   2                   2 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 
##                   2                   1                   1 
##        Lotus Europa      Ford Pantera L        Ferrari Dino 
##                   1                   2                   1 
##       Maserati Bora          Volvo 142E 
##                   2                   1 
## 
## Within cluster sum of squares by cluster:
## [1] 58920.54 93643.90
##  (between_SS / total_SS =  75.5 %)
## 
## Available components:
## 
## [1] &amp;quot;cluster&amp;quot;      &amp;quot;centers&amp;quot;      &amp;quot;totss&amp;quot;        &amp;quot;withinss&amp;quot;    
## [5] &amp;quot;tot.withinss&amp;quot; &amp;quot;betweenss&amp;quot;    &amp;quot;size&amp;quot;         &amp;quot;iter&amp;quot;        
## [9] &amp;quot;ifault&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;hierrquico&quot;&gt;Hierárquico&lt;/h3&gt;

&lt;p&gt;No modelo hierárquico, contudo, não selecionamos previamente o número de grupos, e o resultado da análise é um gráfico chamado &lt;em&gt;dendrograma&lt;/em&gt;, que cria uma ordem de agrupamento dos indivíduos, desde o nível mais fragmentado (número de grupos igual ao número de indivíduos) até um agrupamento único.&lt;/p&gt;

&lt;p&gt;Para ajustar o modelo hierárquico, utilizaremos a função &lt;code&gt;hclust&lt;/code&gt;, do pacote &lt;code&gt;stats&lt;/code&gt;. Existem vários métodos para ordenação dos ordenamentos. Utilizaremos aqui o método &lt;code&gt;ward.D&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Diferentemente do método K-means, os métodos hierárquicos partem de uma matriz de distâncias ou, mais genericamente, matriz de dissimilaridades. A matrix de distâncias é uma matriz &lt;code&gt;d&lt;/code&gt; com &lt;code&gt;dim(d) = c(n, n)&lt;/code&gt;, onde &lt;code&gt;n&lt;/code&gt; é o número de indivíduos. Geralmente é uma matriz simétrica, e na diagonal vale zero.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;d &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; dist&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# calcula matriz de distâncias euclidianas.&lt;/span&gt;
str&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;d&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Class &amp;#39;dist&amp;#39;  atomic [1:496] 0.615 54.909 98.113 210.337 65.472 ...
##   ..- attr(*, &amp;quot;Size&amp;quot;)= int 32
##   ..- attr(*, &amp;quot;Labels&amp;quot;)= chr [1:32] &amp;quot;Mazda RX4&amp;quot; &amp;quot;Mazda RX4 Wag&amp;quot; &amp;quot;Datsun 710&amp;quot; &amp;quot;Hornet 4 Drive&amp;quot; ...
##   ..- attr(*, &amp;quot;Diag&amp;quot;)= logi FALSE
##   ..- attr(*, &amp;quot;Upper&amp;quot;)= logi FALSE
##   ..- attr(*, &amp;quot;method&amp;quot;)= chr &amp;quot;euclidean&amp;quot;
##   ..- attr(*, &amp;quot;call&amp;quot;)= language dist(x = mtcars)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;hc &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; hclust&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;d&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; method&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;ward.D&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
hc&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## hclust(d = d, method = &amp;quot;ward.D&amp;quot;)
## 
## Cluster method   : ward.D 
## Distance         : euclidean 
## Number of objects: 32&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;plot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;hc&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-39-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-39&quot; /&gt;&lt;/p&gt;

&lt;p&gt;No método hierárquico, portanto, geralmente precisamos tomar 2 decisões para rodar a análise e construir o dendrograma: i) o método para obtenção da matriz de distâncias e o método para ordenação das aglomerações.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;OBS:&lt;/strong&gt; Na análise de agrupamento, muitas vezes a escala das variáveis faz diferença, e variáveis que assumem valores muito altos podem ter uma influência maior do que outras no resultado da análise. Por isso, muitas vezes temos interesse em re-escalar as variáveis, geralmente subtraindo a média e dividindo pelo desvio padrão (normalização). Para isso, veja &lt;code&gt;?scale&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;anlise-fatorial&quot;&gt;Análise Fatorial&lt;/h2&gt;

&lt;p&gt;Outra análise multivariada muito comum é a &lt;em&gt;análise fatorial&lt;/em&gt;. Nesse tipo de estudo, geralmente estamos interessados em obter combinações de variáveis que estejam associadas a alguma variável latente não observável. Em palavras mais simples, estamos interessados em obter alguns &lt;em&gt;fatores&lt;/em&gt; que expliquem a variabilidade dos nossos dados, e depois interpretar esses fatores de alguma forma.&lt;/p&gt;

&lt;p&gt;Para realizar análise fatorial, vamos utilizar a função &lt;code&gt;factanal&lt;/code&gt; do pacote &lt;code&gt;stats&lt;/code&gt;. Essa função realiza análise fatorial usando método de máxima verossimilhança. Podemos utilizar outros métodos, como decomposição espectral (autovalor e autovetor), geralmente utilizada em &lt;em&gt;análise de componentes principais&lt;/em&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fa &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; factanal&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; factors&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; rotation&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;none&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
fa&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Call:
## factanal(x = mtcars, factors = 3, rotation = &amp;quot;none&amp;quot;)
## 
## Uniquenesses:
##   mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb 
## 0.135 0.055 0.090 0.127 0.290 0.060 0.051 0.223 0.208 0.125 0.158 
## 
## Loadings:
##      Factor1 Factor2 Factor3
## mpg  -0.910   0.137  -0.136 
## cyl   0.962          -0.135 
## disp  0.937  -0.174         
## hp    0.875   0.292   0.147 
## drat -0.689   0.453   0.175 
## wt    0.858  -0.382   0.242 
## qsec -0.591  -0.754   0.177 
## vs   -0.809  -0.309   0.164 
## am   -0.522   0.719         
## gear -0.459   0.729   0.365 
## carb  0.594   0.517   0.471 
## 
##                Factor1 Factor2 Factor3
## SS loadings      6.448   2.465   0.565
## Proportion Var   0.586   0.224   0.051
## Cumulative Var   0.586   0.810   0.862
## 
## Test of the hypothesis that 3 factors are sufficient.
## The chi square statistic is 30.53 on 25 degrees of freedom.
## The p-value is 0.205&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pesos &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fa&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;loadings&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nomes&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pesos&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Factor1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Factor2&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;label&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;nomes&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_vline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xintercept&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_hline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;yintercept&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_equal&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-40-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-40&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Na análise fatorial, podemos realizar também a &lt;em&gt;rotação&lt;/em&gt; dos fatores obtidos, para tentar isolar os componentes de cada fator, facilitando a interpretação dos fatores. O método mais comum para realizar a rotação é pelo método &lt;code&gt;varimax&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;fa &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; factanal&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; factors&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; rotation&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;varimax&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

pesos &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; fa&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;loadings&lt;span class=&quot;p&quot;&gt;[,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nomes&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rownames&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pesos&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Factor1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Factor2&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;label&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;nomes&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_vline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xintercept&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_hline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;yintercept&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  coord_equal&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-24-aula07/unnamed-chunk-41-1.png&quot; alt=&quot;plot of chunk unnamed-chunk-41&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A análise fatorial tem muito mais detalhes que foram omitidos. Para um tutorial rápido, ver no &lt;a href=&quot;http://www.statmethods.net/advstats/factor.html&quot;&gt;Quick-R&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;anlise-de-correspondncia-mltipla&quot;&gt;Análise de correspondência múltipla&lt;/h2&gt;

&lt;p&gt;Quando temos uma base de dados com muitas variáveis categóticas, geralmente é difícil analisá-las em conjunto, e muitas vezes ficamos fazendo um monte de tabelas de contingência, o que pode ser doloroso.&lt;/p&gt;

&lt;p&gt;A análise de correspondência múltipla pode ser considerada como uma espécie de &lt;em&gt;análise de componentes principais&lt;/em&gt; para dados categóricos. Ela serve para dar uma “visão geral” da base de dados, reduzindo a dimensionalidade da base e visualizando as associações das variáveis em apenas um gráfico.&lt;/p&gt;

&lt;p&gt;Para realizar a análise, vamos utilizar a função &lt;code&gt;MCA&lt;/code&gt; do pacote &lt;code&gt;FactoMineR&lt;/code&gt;. Esse pacote, aliás, contém diversos métodos para realização de análises multivariadas.&lt;/p&gt;

&lt;p&gt;Como base de dados, utilizaremos &lt;code&gt;tea&lt;/code&gt; do pacote &lt;code&gt;FactoMiner&lt;/code&gt;, que é basicamente um questionário aplicado a 300 pessoas sobre como elas tomam chá.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;FactoMiner&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(FactoMiner): there is no package called &amp;#39;FactoMiner&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;data&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tea&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Warning in data(tea): data set &amp;#39;tea&amp;#39; not found&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Vamos trabalhas só com essas colunas&lt;/span&gt;
newtea &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; tea &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;Tea&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; How&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; how&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; sugar&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; where&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; always&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; tbl_df&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;tea&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;newtea&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;newtea&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# numero de niveis de cada variavel&lt;/span&gt;
cats &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; newtea &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; summarise_each&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;funs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;unique&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;newtea&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;cats&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;cats&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# MCA&lt;/span&gt;
mca &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; MCA&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;newtea&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; graph &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): não foi possível encontrar a função &amp;quot;MCA&amp;quot;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Coordenadas das variaveis&lt;/span&gt;
mca1_vars_df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mca&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;var&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;coord&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; variavel&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;rep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cats&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; cats&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; stringsAsFactors&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;rnames&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;row.names&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in data.frame(mca$var$coord, variavel = rep(names(cats), cats), : objeto &amp;#39;mca&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Coordenadas das observacoes&lt;/span&gt;
mca1_obs_df &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;data.frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mca&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;ind&lt;span class=&quot;o&quot;&gt;$&lt;/span&gt;coord&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in data.frame(mca$ind$coord): objeto &amp;#39;mca&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# Um gráfico bonito&lt;/span&gt;
ggplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_hline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;yintercept &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;gray70&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_vline&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;xintercept &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;gray70&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_text&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Dim.1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Dim.2&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;variavel&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; label&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;rnames&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mca1_vars_df&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Dim.1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Dim.2&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;gray50&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; alpha &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;0.7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mca1_obs_df&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_density2d&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Dim.1&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Dim.2&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;gray80&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mca1_obs_df&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in do.call(&amp;quot;layer&amp;quot;, list(mapping = mapping, data = data, stat = stat, : objeto &amp;#39;mca1_vars_df&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;O gráfico mostra várias coisas de uma vez só.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;A dispersão mostra as dimensões calculadas pelo método de análise de correspondência múltipla.&lt;/li&gt;
  &lt;li&gt;As curvas de nível mostram a concentração dos dados.&lt;/li&gt;
  &lt;li&gt;Os textos são os níveis das variáveis, identificados pela cor.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Nesse caso, verificamos, por exemplo, que pode existir uma associação entre &lt;code&gt;how&lt;/code&gt; e &lt;code&gt;where&lt;/code&gt;, pois “tea bag” está muito próximo de “chain store”.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;OBS:&lt;/strong&gt; Baseado no excelente post de &lt;a href=&quot;http://gastonsanchez.com/blog/how-to/2012/10/13/MCA-in-R.html&quot;&gt;Gaston Sanchez&lt;/a&gt;.&lt;/p&gt;

&lt;h1 id=&quot;demais-tpicos&quot;&gt;Demais tópicos&lt;/h1&gt;

&lt;ul&gt;
  &lt;li&gt;Séries temporais&lt;/li&gt;
  &lt;li&gt;Dados categorizados&lt;/li&gt;
  &lt;li&gt;GAM/GAMLSS&lt;/li&gt;
  &lt;li&gt;Inferência Bayesiana&lt;/li&gt;
  &lt;li&gt;Processos estocásticos&lt;/li&gt;
  &lt;li&gt;Reamostragem&lt;/li&gt;
  &lt;li&gt;Muito mais!&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;referncias&quot;&gt;Referências&lt;/h1&gt;

&lt;p&gt;http://www-bcf.usc.edu/~gareth/ISL/ISLR%20First%20Printing.pdf&lt;/p&gt;

&lt;p&gt;http://web.stanford.edu/~hastie/local.ftp/Springer/OLD/ESLII_print4.pdf&lt;/p&gt;

&lt;p&gt;http://www.ime.usp.br/~giapaula/texto_2013.pdf&lt;/p&gt;

&lt;p&gt;Colosimo, E.A. e Giolo, S.R. (2006) Análise de sobrevivência aplicada. ABE - Projeto Fisher, Blucher.&lt;/p&gt;

&lt;p&gt;http://adv-r.had.co.nz/Functions.html&lt;/p&gt;

&lt;p&gt;http://www.burns-stat.com/pages/Tutor/R_inferno.pdf&lt;/p&gt;
</description>
        <pubDate>Mon, 02 Feb 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula07/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula07/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 06 - Laboratório II</title>
        <description>&lt;h1 id=&quot;questes-iniciais&quot;&gt;Questões iniciais&lt;/h1&gt;

&lt;h2 id=&quot;sobre-dplyr-e-tidyr&quot;&gt;Sobre dplyr e tidyr&lt;/h2&gt;

&lt;p&gt;Para estas questões usaremos a base de dados flights, ela está inserida no pacote &lt;code&gt;nycflights13&lt;/code&gt; por isso é necessário utilizar o comando:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;nycflights13&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in library(nycflights13): there is no package called &amp;#39;nycflights13&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Se você não tiver o pacote instalado use o comando:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;install.packages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;nycflighs13&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;E em seguida use o &lt;code&gt;library(nycflights13)&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;dplyr&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## 
## Attaching package: &amp;#39;dplyr&amp;#39;
## 
## The following objects are masked from &amp;#39;package:stats&amp;#39;:
## 
##     filter, lag
## 
## The following objects are masked from &amp;#39;package:base&amp;#39;:
## 
##     intersect, setdiff, setequal, union&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;flights &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt; tbl_df&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;flights&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Com o comando &lt;code&gt;?flights&lt;/code&gt; você pode ver o que significa cada uma das variáveis do banco de dados.&lt;/p&gt;

&lt;h3 id=&quot;filter&quot;&gt;filter&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Atribua a uma tabela apenas os voos de janeiro de 2013.&lt;/li&gt;
  &lt;li&gt;Atribua a uma tabela apenas os voos de janeiro ou fevereiro de 2013.&lt;/li&gt;
  &lt;li&gt;Atribua a uma tabela apenas os vôos com distância maior do que 1000 milhas.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;select&quot;&gt;select&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Atribua a uma tabela apenas as colunas &lt;code&gt;month&lt;/code&gt; e &lt;code&gt;dep_delay&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Atribua a uma tabela apenas as colunas &lt;code&gt;month&lt;/code&gt; e &lt;code&gt;dep_delay&lt;/code&gt;, os nomes dessas colunas devem ser &lt;code&gt;mes&lt;/code&gt;e &lt;code&gt;atraso&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Retire da tabela as colunas &lt;code&gt;tailnum&lt;/code&gt;, &lt;code&gt;origin&lt;/code&gt; e &lt;code&gt;dest&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;mutate&quot;&gt;mutate&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Calcule as colunas &lt;code&gt;ganho_de_tempo&lt;/code&gt; que é dado por &lt;code&gt;dep_delay - arr_delay&lt;/code&gt; e &lt;code&gt;velocidade&lt;/code&gt; dada por &lt;code&gt;distance / air_time * 60&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Calcule o horário de chegada considerando as colunas &lt;code&gt;hour&lt;/code&gt;, &lt;code&gt;minute&lt;/code&gt; e &lt;code&gt;air_time&lt;/code&gt;. A tabela deve conter duas colunas novas: &lt;code&gt;hour2&lt;/code&gt; com a hora de chegada e &lt;code&gt;minute2&lt;/code&gt; com o minuto de chegada.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;summarise&quot;&gt;summarise&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Calcule a média da distância de todos os vôos.&lt;/li&gt;
  &lt;li&gt;Calcule a média da distância dos vôos por mês&lt;/li&gt;
  &lt;li&gt;Calcule a média, mediana, primeiro quartil e terceiro quartil do tempo de viagem por mês.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;arrange&quot;&gt;arrange&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Ordene a base de dados pelo atraso na partida em ordem crescente.&lt;/li&gt;
  &lt;li&gt;Repita a questão anterior, porém na ordem decrescente.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;spread&quot;&gt;spread&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Crie uma tabela em que cada linha é um dia e cada coluna é o atraso médio de partida por mês.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Resultado esperado:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;flights&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Dica: você precisará usar &lt;code&gt;group_by&lt;/code&gt;, &lt;code&gt;summarise&lt;/code&gt;e &lt;code&gt;spread&lt;/code&gt;. Lembre-se também do argumento &lt;code&gt;na.rm&lt;/code&gt;.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Repita a mesma operação, mas dessa vez cada coluna será uma hora do dia.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Resultado esperado:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;flights&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;gather&quot;&gt;gather&lt;/h3&gt;

&lt;p&gt;Considerando as tabelas criadas nas perguntas sobre o &lt;code&gt;spread&lt;/code&gt;:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Transforme-as em um formato tidy.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Resultado esperado:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;flights&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;desafios-opcional&quot;&gt;desafios (opcional)&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Sumarise em uma tabela qual foi a média de atraso total (&lt;code&gt;dep_delay + arr_delay&lt;/code&gt;) e seu intervalo de confiança por mês, apenas considerando os vôos que atrasaram (tempos negativos não são atrasos).
Dica: o intervalo de confiança pode ser calculado por $média \pm 1,96*\sqrt{\frac{var(x)}{n}}$&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Summarise em uma tabela quais foram os 10 destinos com mais viagens com atraso superior a 60 minutos. Considere o atraso total definido na pergunta anterior.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;sobre-ggplot2&quot;&gt;Sobre ggplot2&lt;/h2&gt;

&lt;p&gt;Nestes exercícios você utilizará a base de dados &lt;code&gt;diamonds&lt;/code&gt;, do pacote &lt;code&gt;ggplot2&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Instalação do pacote &lt;code&gt;ggplot2&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;install.packages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;ggplot2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para carregar o pacote &lt;code&gt;ggplot2&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Carregando pacotes exigidos: methods&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Enfim, os dados:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;diamonds&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##    carat       cut color clarity depth table price    x    y    z
## 1   0.23     Ideal     E     SI2  61.5    55   326 3.95 3.98 2.43
## 2   0.21   Premium     E     SI1  59.8    61   326 3.89 3.84 2.31
## 3   0.23      Good     E     VS1  56.9    65   327 4.05 4.07 2.31
## 4   0.29   Premium     I     VS2  62.4    58   334 4.20 4.23 2.63
## 5   0.31      Good     J     SI2  63.3    58   335 4.34 4.35 2.75
## 6   0.24 Very Good     J    VVS2  62.8    57   336 3.94 3.96 2.48
## 7   0.24 Very Good     I    VVS1  62.3    57   336 3.95 3.98 2.47
## 8   0.26 Very Good     H     SI1  61.9    55   337 4.07 4.11 2.53
## 9   0.22      Fair     E     VS2  65.1    61   337 3.87 3.78 2.49
## 10  0.23 Very Good     H     VS1  59.4    61   338 4.00 4.05 2.39&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Para ver uma descrição das variáveis deste banco de dados, utilize a função &lt;code&gt;help()&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;help&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;diamonds&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;geral&quot;&gt;Geral&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;1.&lt;/strong&gt; Segundo a &lt;em&gt;Grammar of Graphics&lt;/em&gt;, o que é um gráfico estatístico? Responda de forma sucinta.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2.&lt;/strong&gt; Qual operador é usado para acrescentar &lt;em&gt;camadas&lt;/em&gt; em um gráfico no ggplot?&lt;/p&gt;

&lt;h3 id=&quot;geompoint&quot;&gt;geom_point&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;3.&lt;/strong&gt; Quais são os aspectos estéticos (&lt;em&gt;aesthetics&lt;/em&gt;) exigidos (obrigatórios) da função &lt;code&gt;geom_point()&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;Dica: utilizar a função &lt;code&gt;help()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4.&lt;/strong&gt; Faça um gráfico de dispersão do preço (&lt;em&gt;price&lt;/em&gt;) pela variável quilates (&lt;em&gt;carat&lt;/em&gt;). Utilize as funções &lt;code&gt;xlab()&lt;/code&gt; e &lt;code&gt;ylab()&lt;/code&gt; para trocar os &lt;em&gt;labels&lt;/em&gt; dos eixos x e y, respectivamente.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5.&lt;/strong&gt; Utilize a função &lt;code&gt;facet_grid()&lt;/code&gt; ou &lt;code&gt;facet_wrap()&lt;/code&gt; para fazer gráficos de dispersão do preço pela variável quilate (o mesmo gráfico do exercício 1) para cada nível da variável claridade (&lt;em&gt;clarity&lt;/em&gt;).&lt;/p&gt;

&lt;h3 id=&quot;geomline&quot;&gt;geom_line&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;6.&lt;/strong&gt; Quais são os aspectos estéticos (&lt;em&gt;aesthetics&lt;/em&gt;) exigidos (obrigatórios) da função &lt;code&gt;geom_line()&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;Dica: visitar a seguinte &lt;a href=&quot;http://docs.ggplot2.org/current/&quot;&gt;página&lt;/a&gt; e consultar o tópico &lt;code&gt;geom_line&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;7.&lt;/strong&gt; Utilizando o argumento &lt;code&gt;stat = summary&lt;/code&gt; e &lt;code&gt;fun.y = mean&lt;/code&gt;, calcule a média do preço para cada corte, faça um gráfico desses pontos utilizando a função &lt;code&gt;geom_point()&lt;/code&gt;e trace uma reta sobre esses pontos utilizando a função &lt;code&gt;geom_line()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Dicas: não se esqueça de especificar o &lt;em&gt;aesthetic&lt;/em&gt; &lt;code&gt;group =&lt;/code&gt; dentro do &lt;code&gt;geom_line()&lt;/code&gt;. Veja mais exemplos de como usar o &lt;code&gt;stat = summary&lt;/code&gt; &lt;a href=&quot;http://docs.ggplot2.org/current/stat_summary.html&quot;&gt;aqui&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;geomhistogram&quot;&gt;geom_histogram&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;8.&lt;/strong&gt; Quais são os aspectos estéticos (&lt;em&gt;aesthetics&lt;/em&gt;) exigidos (obrigatórios) da função &lt;code&gt;geom_histogram()&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;9.&lt;/strong&gt; Faça um histograma da variável preço.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;10.&lt;/strong&gt; Utilize a função &lt;code&gt;geom_density()&lt;/code&gt; para &lt;strong&gt;adicionar&lt;/strong&gt; ao gráfico anterior uma estimativa suavizada da densidade. Por que, neste caso, é preciso especificar o argumento &lt;code&gt;y = &lt;/code&gt; como &lt;code&gt;..density..&lt;/code&gt;?&lt;/p&gt;

&lt;h3 id=&quot;geomboxplot&quot;&gt;geom_boxplot&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;11.&lt;/strong&gt; Quais são os aspectos estéticos (&lt;em&gt;aesthetics&lt;/em&gt;) exigidos (obrigatórios) da função &lt;code&gt;geom_boxplot()&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;12.&lt;/strong&gt; Faça boxplots da variável preço pela variável corte (&lt;em&gt;cut&lt;/em&gt;).&lt;/p&gt;

&lt;h3 id=&quot;geombar&quot;&gt;geom_bar&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;13.&lt;/strong&gt; Quais são os aspectos estéticos (&lt;em&gt;aesthetics&lt;/em&gt;) exigidos (obrigatórios) da função &lt;code&gt;geom_bar()&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;14.&lt;/strong&gt; Faça um gráfico de barras do número de diamantes em cada categoria da variável cor (&lt;em&gt;color&lt;/em&gt;).&lt;/p&gt;

&lt;h3 id=&quot;desafio-opcional&quot;&gt;Desafio (opcional)&lt;/h3&gt;

&lt;p&gt;Supondo que esses diamantes são vendidos nos EUA, siga os seguintes passos:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Considerando que, para obter o seu lucro, um vendedor brasileiro venda um diamante (em reais) por &lt;code&gt;2.61*price*2.2&lt;/code&gt;, acrescente uma coluna ao banco de dados representando o preço de venda no Brasil.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Considere agora que, para importar um diamante diretamente dos EUA, uma transportadora cobre (em reais) &lt;code&gt;(carat*price*0.70)*2.61 + price*2.68&lt;/code&gt;, já considerando o preço de compra do diamante. Adicione ao banco de dados uma coluna referente ao preço de cada diamante se importado diretamente.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Faça um gráfico de dispersão do preço de venda no Brasil pelo preço de importação. Adicione a esse gráfico uma reta x=y para avaliar quais diamantes compensam ser importados diretamente.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Mapeie a variável &lt;em&gt;clarity&lt;/em&gt; ao gráfico acima. Quais são os tipos de claridades que, em geral, não compensam ser importadas diretamente? Faça o mesmo para a variável &lt;em&gt;color&lt;/em&gt;.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Dica&lt;/em&gt;: para fazer a reta x=y, utilize a função &lt;code&gt;geom_abline()&lt;/code&gt;.&lt;/p&gt;

&lt;h1 id=&quot;desafios-com-bases-de-dados-reais&quot;&gt;Desafios com bases de dados reais&lt;/h1&gt;

&lt;p&gt;Primeiro, instale o pacote &lt;code&gt;abjutils&lt;/code&gt;. Para isso, instale primeiro o pacote &lt;code&gt;devtools&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# verifica se o pacote devtools já está instalado e instala se não estiver&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;devtools&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; install.packages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;devtools&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# verifica se o pacote abjutils já está instalado e instala se não estiver&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Como o pacote não está no CRAN, instalamos via github usando o comando do pacote devtools&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;abjutils&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; devtools&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;install_github&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;abjur/abjutils&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# OBS: O pacote abjutils já vai carregar as bibliotecas dplyr, stringr e lubridate&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;pnud&quot;&gt;PNUD&lt;/h2&gt;

&lt;p&gt;Vamos começar com a base de dados do PNUD do lab 1, para aquecer :)&lt;/p&gt;

&lt;p&gt;Você pode carregar o banco de dados do PNUD rodando&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;data&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pnud_muni &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; package&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;abjutils&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;1&lt;/strong&gt; Refaça todas as análises do laboratório 1 usando &lt;code&gt;dplyr&lt;/code&gt; e &lt;code&gt;ggplot2&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;coalitions&quot;&gt;Coalitions&lt;/h2&gt;

&lt;p&gt;Essa base de dados contém informações de países que fazem parte da Organização Mundial do Comércio (OMC, em inglês World Trade Organization - WTO). Para melhorar e facilitar o comércio internacional, muitas vezes os países que fazem parte da OMC realizam acordos, que chamamos de &lt;em&gt;coalizões&lt;/em&gt;. Geralmente uma coalizão
envolve muitos países ao mesmo tempo.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;data&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wto_data &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; package&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;abjutils&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
data&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;wto_dyad_sample&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; package&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;abjutils&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;A base de dados &lt;code&gt;wto_data&lt;/code&gt; contém informações básicas de cada país, como PIB, PIB &lt;em&gt;per capita&lt;/em&gt;, latitude, longitude, hemisfério, identificador de regime político, etc. O código do país é dado na variável &lt;code&gt;ccode&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;A base de dados &lt;code&gt;wto_dyad_sample&lt;/code&gt; contém, em cada linha, uma coalizão ocorrida ou não na Organização Mundial do Comércio, entre dois países (uma “díade” ou, em inglês, &lt;em&gt;dyad&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;Os países estão identificados pelas colunas &lt;code&gt;ccode1&lt;/code&gt; e &lt;code&gt;ccode2&lt;/code&gt; (analogamente à base &lt;code&gt;wto_data&lt;/code&gt;). A coalizão é identificada &lt;code&gt;coalition&lt;/code&gt;, que vale &lt;code&gt;1&lt;/code&gt; se houve coalizão e &lt;code&gt;0&lt;/code&gt; caso contrário. A coluna &lt;code&gt;ccoalition&lt;/code&gt; é um identificador de qual foi a coalizão que aconteceu (Mercosul, acordos da Europa, etc).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;1&lt;/strong&gt; Faça um mapa com as posições geográficas dos países, com um mapa múndi no fundo.&lt;/p&gt;

&lt;p&gt;Dica: Leia o script da aula 05.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2&lt;/strong&gt;. Qual é a unidade observacional (o que identifica uma observação) na base &lt;code&gt;wto_data&lt;/code&gt;?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3&lt;/strong&gt;. Quantas coalizões tivemos em cada ano?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4&lt;/strong&gt;. Qual é o código do país que entrou mais vezes em alguma coalizão?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5&lt;/strong&gt;. Construa uma matriz de adjacências usando &lt;code&gt;dplyr&lt;/code&gt; e &lt;code&gt;tidyr&lt;/code&gt;. Queremos um &lt;code&gt;data.frame&lt;/code&gt; &lt;code&gt;wto_adj&lt;/code&gt; com número de linhas igual ao número de colunas, e o conteúdo da célula &lt;code&gt;wto_adj[i, j]&lt;/code&gt; é &lt;code&gt;1&lt;/code&gt; se o país da linha entra em coalizão com o país da coluna em dado ano e dada coalizão, e &lt;code&gt;0&lt;/code&gt; caso contrário. Utilize a função &lt;code&gt;row.names()&lt;/code&gt; para atribuir os nomes às linhas.&lt;/p&gt;

&lt;h2 id=&quot;carf&quot;&gt;CARF&lt;/h2&gt;

&lt;p&gt;A base de dados do Conselho Administrativo de Recursos Fiscais (CARF) é uma das muitas bases que geralmente temos de lidar na área de jurimetria (estatística aplicada ao direito). Trata-se de uma base de dados sobre processos tributários.&lt;/p&gt;

&lt;p&gt;Montamos uma base de dados com todas as decisões encontradas no conselho. Nosso banco de dados tem, inicialmente, 264594 linhas e somente 9 colunas. As variáveis estão descritas abaixo:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;id&lt;/code&gt;: número sequencial único para identificar cada acórdão.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;n_processo&lt;/code&gt;: número do processo.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;n_decisao&lt;/code&gt;: número da decisão.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;ano&lt;/code&gt;: ano em que o acórdão foi proferido (de acordo com o site do CARF).&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;tipo_recurso&lt;/code&gt;: identifica se a decisão é sobre um recurso voluntário, recurso de ofício, recurso especial, etc.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;contribuinte&lt;/code&gt;: identifica o nome do contribuinte, em texto livre.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;relator&lt;/code&gt;: identifica o nome do relator, em texto livre.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;txt_ementa&lt;/code&gt;: texto completo da ementa, em texto livre. Geralmente esse texto contém informações do tributo discutido, fundamentação da decisão e decisão.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;txt_decisao&lt;/code&gt;: texto completo da decisão, em texto livre. Geralmente é uma parte da ementa, contendo apenas a parte relacionada à decisão, mas não é uma regra.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;1&lt;/strong&gt; Quantos processos temos na base de dados?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2&lt;/strong&gt; Construa um gráfico contendo o volume de acórdãos em cada ano. Você nota algum ano com comportamento estranho?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3&lt;/strong&gt; Agora retire da base os acórdãos que contêm texto da decisão e texto da ementa vazios. Refaça o gráfico e interprete.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4&lt;/strong&gt; Utilizando a função &lt;code&gt;str_detect()&lt;/code&gt;, crie colunas (que valem &lt;code&gt;TRUE&lt;/code&gt; ou &lt;code&gt;FALSE&lt;/code&gt;) na base de dados de acordo com as expressões regulares abaixo.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;negar_provimento &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;negar?(do)? (o )?provimento|negou se (o )?provimento|recurso nao provido&amp;#39;&lt;/span&gt;
dar_provimento &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;dar?(do)? (o )?provimento|deu se (o )?provimento|recurso provido&amp;#39;&lt;/span&gt;
em_parte &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;em parte|parcial&amp;#39;&lt;/span&gt;
diligencia &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;diligencia&amp;#39;&lt;/span&gt;
nao_conhecer &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;conhec&amp;#39;&lt;/span&gt;
anular &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;nul(a|o|i)&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;5&lt;/strong&gt; Faça um gráfico de barras mostrando a quantidade de acórdãos em que foi dado provimento, negado provimento, etc. Considere somente os casos em que &lt;code&gt;tipo_recurso&lt;/code&gt; é recurso voluntário.&lt;/p&gt;

&lt;h2 id=&quot;sabesp&quot;&gt;SABESP&lt;/h2&gt;

&lt;p&gt;Usando um &lt;em&gt;web crawler&lt;/em&gt; desenvolvido em R, fizemos o download da base de dados da SABESP. Quem tiver interesse nesses dados, acesse &lt;a href=&quot;https://github.com/jtrecenti/sabesp&quot;&gt;aqui&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;data&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;sabesp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; package&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;abjutils&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;1&lt;/strong&gt; Descreva a base de dados.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;2&lt;/strong&gt; Crie um boxplot por mês, mostrando os lugares separadamente.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;3&lt;/strong&gt; Tente montar um gráfico parecido com esse (inclusive as cores e as labels inclinadas do eixo x). Não vale olhar o código do repositório no github!&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/jtrecenti/sabesp/master/sabesp_files/figure-html/unnamed-chunk-2-2.png&quot; /&gt; &amp;lt;/img&amp;gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;4&lt;/strong&gt; Construa uma tabela descritiva contendo a média, mediana, desvio padrão, primeiro e terceiro quartis em relação à pluviometria, agrupando por ano e por lugar.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;5&lt;/strong&gt; Comente sobre a crise hídrica em São Paulo com base em conhecimentos próprios e usando os dados da sabesp.&lt;/p&gt;
</description>
        <pubDate>Fri, 30 Jan 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula06/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula06/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 05 - Gráficos com estilo - ggplot2</title>
        <description>&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/slides/aula_05_apresentacao.html&quot; target=&quot;_blank&quot;&gt;Slides dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/script/aula_05.R&quot; target=&quot;_blank&quot;&gt;Script dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;h1 id=&quot;o-pacote-ggplot2&quot;&gt;O pacote ggplot2&lt;/h1&gt;

&lt;p&gt;O &lt;code&gt;ggplot2&lt;/code&gt; é um pacote do R voltado para a criação de gráficos estatísticos. Ele é baseado na Gramática dos Gráficos (&lt;em&gt;grammar of graphics&lt;/em&gt;, em inglês), criado por Leland Wilkinson, que é uma resposta para a pergunta: o que é um gráfico estatístico? Resumidamente, a gramática diz que um gráfico estatístico é um mapeamento dos dados a partir de atributos estéticos (cores, formas, tamanho) de formas geométricas (pontos, linhas, barras).&lt;/p&gt;

&lt;p&gt;Para mais informações sobre a Gramática dos Gráficos, você pode consultar o livro &lt;a href=&quot;http://www.springer.com/statistics/computational+statistics/book/978-0-387-24544-7&quot;&gt;&lt;em&gt;The Grammar of graphics&lt;/em&gt;&lt;/a&gt;, escrito pelo Leland Wilkinson, ou o livro &lt;a href=&quot;http://ggplot2.org/book/&quot;&gt;ggplot2: elegant graphics for data analysis&lt;/a&gt;, do Hadley Wickham.&lt;/p&gt;

&lt;h2 id=&quot;instalao&quot;&gt;Instalação&lt;/h2&gt;

&lt;p&gt;O &lt;code&gt;ggplot2&lt;/code&gt; não faz parte dos pacotes base do R. Assim, antes de usá-lo, você precisa baixar e instalar o pacote. Para isso, é necessário ter pelo menos a versão 2.8 do R, pois o &lt;code&gt;ggplot2&lt;/code&gt; não é compatível com versões anteriores.&lt;/p&gt;

&lt;p&gt;Para baixar e instalar o pacote, utilize a seguitne linha de código:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;install.packages&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;ggplot2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Não se esqueça de carregar o pacote antes de utilizá-lo:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kn&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ggplot2&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Carregando pacotes exigidos: methods&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h1 id=&quot;construindo-grficos&quot;&gt;Construindo gráficos&lt;/h1&gt;

&lt;p&gt;A seguir, vamos discutir os aspcetos básicos para a construção de gráficos com o pacote &lt;code&gt;gglplot2&lt;/code&gt;. Para isso, utilizaremos o banco de dados contido no objeto &lt;code&gt;mtcars&lt;/code&gt;. Para visualizar as primeiras linhas deste banco, utilize o comando:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;kp&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;as-camadas-de-um-grfico&quot;&gt;As camadas de um gráfico&lt;/h2&gt;

&lt;p&gt;No &lt;code&gt;ggplot2&lt;/code&gt;, os gráficos são construídos camada por camada (ou, &lt;em&gt;layers&lt;/em&gt;, em inglês), sendo que a primeira delas é dada pela função &lt;code&gt;ggplot&lt;/code&gt; (não tem o “2”). Cada camada representa um tipo de mapeamento ou personalização do gráfico. O código abaixo é um exemplo de um gráfico bem simples, construído a partir das duas principais camadas.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; disp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk03-1.png&quot; alt=&quot;plot of chunk aula05chunk03&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Observe que o primeiro argumento da função &lt;code&gt;ggplot&lt;/code&gt; é um data frame. A função &lt;code&gt;aes()&lt;/code&gt; descreve como as variáveis são mapeadas em aspectos visuais de formas geométricas definidas pelos &lt;em&gt;geoms&lt;/em&gt;. Aqui, essas formas geométricas são pontos, selecionados pela função &lt;code&gt;geom_point()&lt;/code&gt;, gerando, assim, um gráfico de dispersão. A combinação dessas duas camadas define o tipo de gráfico que você deseja construir.&lt;/p&gt;

&lt;h3 id=&quot;aesthetics&quot;&gt;Aesthetics&lt;/h3&gt;

&lt;p&gt;A primeira camada de um gráfico deve indicar a relação entre os dados e cada aspecto visual do gráfico, como qual variável será representada no eixo x, qual será representada no eixo y, a cor e o tamanho dos componentes geométricos etc. Os aspectos que podem ou devem ser mapeados depende do tipo de gráfico que você deseja fazer.&lt;/p&gt;

&lt;p&gt;No exemplo acima, atribuímos aspectos de posição: ao eixo y mapeamos a variável &lt;code&gt;mpg&lt;/code&gt; (milhas por galão) e ao eixo x a variável &lt;code&gt;disp&lt;/code&gt; (cilindradas). Outro aspecto que pode ser mapeado nesse gráfico é a cor dos pontos&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;data &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; disp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk04-1.png&quot; alt=&quot;plot of chunk aula05chunk04&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Agora, a variável &lt;code&gt;am&lt;/code&gt; (tipo de transmissão) foi mapeada à cor dos pontos, sendo que pontos vermelhos correspondem à transmissão automática (valor 0) e pontos azuis à transmissão manual (valor 1). Observe que inserimos a variável &lt;code&gt;am&lt;/code&gt; como um fator, pois temos interesse apenas nos valores “0” e “1”. No entanto, tambem podemos mapear uma variável contínua à cor dos pontos:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; disp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; cyl&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk05-1.png&quot; alt=&quot;plot of chunk aula05chunk05&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Aqui, o número de cilindros, &lt;code&gt;cyl&lt;/code&gt;, é representado pela tonalidade da cor azul.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: por &lt;em&gt;default&lt;/em&gt;, a legenda é insirida no gráfico automaticamente.&lt;/p&gt;

&lt;p&gt;Também podemos mapear o tamanho dos pontos à uma variável de interesse:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; disp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; cyl&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; size &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; wt&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk06-1.png&quot; alt=&quot;plot of chunk aula05chunk06&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Exercício&lt;/strong&gt;: pesquisar mais aspectos que podem ser alterados no gráfico de dispersão.&lt;/p&gt;

&lt;h3 id=&quot;geoms&quot;&gt;Geoms&lt;/h3&gt;

&lt;p&gt;Os &lt;em&gt;geoms&lt;/em&gt; definem qual forma geométrica será utilizada para a visualização dos dados no gráfico. Como já vimos, a função &lt;code&gt;geom_point()&lt;/code&gt; gera gráficos de dispersão transformando pares (x,y) em pontos. Veja a seguir outros &lt;em&gt;geoms&lt;/em&gt; bastante utilizados:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;geom_line: para retas definidas por pares (x,y)&lt;/li&gt;
  &lt;li&gt;geom_abline: para retas definidas por um intercepto e uma inclinação&lt;/li&gt;
  &lt;li&gt;geom_hline: para retas horizontais&lt;/li&gt;
  &lt;li&gt;geom_boxplot: para boxplots&lt;/li&gt;
  &lt;li&gt;geom_histogram: para histogramas&lt;/li&gt;
  &lt;li&gt;geom_density: para densidades&lt;/li&gt;
  &lt;li&gt;geom_area: para áreas&lt;/li&gt;
  &lt;li&gt;geom_bar: para barras&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Veja a seguir como é fácil gerar diversos gráficos diferentes utilizando a mesma estrutura do gráfico de dispersão acima:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_boxplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk07-1.png&quot; alt=&quot;plot of chunk aula05chunk07&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_histogram&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## stat_bin: binwidth defaulted to range/30. Use &amp;#39;binwidth = x&amp;#39; to adjust this.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk08-1.png&quot; alt=&quot;plot of chunk aula05chunk08&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_bar&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk09-1.png&quot; alt=&quot;plot of chunk aula05chunk09&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Para fazer um boxplot para cada grupo, precisamos passar para o aspecto x do gráfico uma variável do tipo fator.&lt;/p&gt;

&lt;h2 id=&quot;personalizando-os-grficos&quot;&gt;Personalizando os gráficos&lt;/h2&gt;

&lt;h3 id=&quot;cores&quot;&gt;Cores&lt;/h3&gt;

&lt;p&gt;O aspecto colour do boxplot, muda a cor do contorno. Para mudar o preenchimento, basta usar o &lt;code&gt;fill&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_boxplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk10-1.png&quot; alt=&quot;plot of chunk aula05chunk10&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; geom_boxplot&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk11-1.png&quot; alt=&quot;plot of chunk aula05chunk11&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Você pode também mudar a cor dos objetos sem mapeá-la a uma variável. Para isso, observe que os aspectos &lt;code&gt;colour&lt;/code&gt; e &lt;code&gt;fill&lt;/code&gt; são especificados fora do &lt;code&gt;aes()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_boxplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;color &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;pink&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk12-1.png&quot; alt=&quot;plot of chunk aula05chunk12&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;eixos&quot;&gt;Eixos&lt;/h3&gt;

&lt;p&gt;Para alterar os labels dos eixos acrescentamos as funções &lt;code&gt;xlab()&lt;/code&gt; ou &lt;code&gt;ylab()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_histogram&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  xlab&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Milhas por galão&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  ylab&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Frequência&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## stat_bin: binwidth defaulted to range/30. Use &amp;#39;binwidth = x&amp;#39; to adjust this.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk13-1.png&quot; alt=&quot;plot of chunk aula05chunk13&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Para alterar os limites dos gráficos usamos as funções &lt;code&gt;xlim()&lt;/code&gt; e &lt;code&gt;ylim()&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_histogram&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  xlab&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Milhas por galão&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  ylab&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;Frequência&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  xlim&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  ylim&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## stat_bin: binwidth defaulted to range/30. Use &amp;#39;binwidth = x&amp;#39; to adjust this.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk14-1.png&quot; alt=&quot;plot of chunk aula05chunk14&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;legendas&quot;&gt;Legendas&lt;/h3&gt;

&lt;p&gt;A legenda de um gráfico pode ser facilmente personalizada.&lt;/p&gt;

&lt;p&gt;Para trocar o &lt;em&gt;label&lt;/em&gt; da leganda:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_bar&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  labs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;cyl&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk15-1.png&quot; alt=&quot;plot of chunk aula05chunk15&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Para trocar a posição da legenda:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_bar&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  labs&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;quot;cyl&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  theme&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;legend.position&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;top&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk16-1.png&quot; alt=&quot;plot of chunk aula05chunk16&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Para retirar a legenda:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; fill &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_bar&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  guides&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;fill&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk17-1.png&quot; alt=&quot;plot of chunk aula05chunk17&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Veja mais opções de personalização &lt;a href=&quot;http://www.cookbook-r.com/Graphs/Legends_(ggplot2)/&quot;&gt;aqui!&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;facets&quot;&gt;Facets&lt;/h3&gt;

&lt;p&gt;Outra funcionalidade muito importante do ggplot é o uso de &lt;em&gt;facets&lt;/em&gt;.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; disp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  facet_grid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;am&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk18-1.png&quot; alt=&quot;plot of chunk aula05chunk18&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Podemos colocar os graficos lado a lado também:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;ggplot&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;mtcars&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; aes&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; mpg&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; disp&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; colour &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;as.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;cyl&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
  geom_point&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; 
  facet_grid&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;am&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/2016-01-26-aula05/aula05chunk19-1.png&quot; alt=&quot;plot of chunk aula05chunk19&quot; /&gt;&lt;/p&gt;

</description>
        <pubDate>Wed, 28 Jan 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula05/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula05/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 04 - Manipulação de dados</title>
        <description>&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/slides/aula_04_apresentacao.html&quot; target=&quot;_blank&quot;&gt;Slides dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://curso-r.github.io/script/aula_04.R&quot; target=&quot;_blank&quot;&gt;Script dessa aula&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in find.package(package, lib.loc, verbose = verbose): there is no package called &amp;#39;abjutils&amp;#39;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;manipulao-de-dados-com-dplyr&quot;&gt;Manipulação de dados com dplyr&lt;/h2&gt;

&lt;p&gt;A manipulação de dados é uma tarefa usualmente bastante
dolorosa e demorada, podendo muitas vezes tomar mais tempo do que desejaríamos. No entanto,
como nosso interesse geralmente é na modelagem dos dados, essa tarefa é muitas vezes negligenciada.&lt;/p&gt;

&lt;p&gt;O &lt;code&gt;dplyr&lt;/code&gt; é um dos pacotes mais úteis para realizar manipulação de dados, e procura aliar 
simplicidade e eficiência de uma forma bastante elegante. Os scripts em &lt;code&gt;R&lt;/code&gt; que fazem uso 
inteligente dos verbos &lt;code&gt;dplyr&lt;/code&gt; e as facilidades do operador &lt;em&gt;pipe&lt;/em&gt; tendem a ficar mais legíveis e 
organizados, sem perder velocidade de execução.&lt;/p&gt;

&lt;p&gt;Por ser um pacote que se propõe a realizar um dos trabalhos mais árduos da análise estatística,
e por atingir esse objetivo de forma elegante, eficaz e eficiente, o &lt;code&gt;dplyr&lt;/code&gt; pode ser considerado 
como uma revolução no &lt;code&gt;R&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&quot;trabalhando-com-tbl-e-tbldf&quot;&gt;Trabalhando com tbl e tbl_df&lt;/h3&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt; tbl_df&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;pnud_muni&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in is.data.frame(data): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;filosofia-do-hadley-para-anlise-de-dados&quot;&gt;Filosofia do Hadley para análise de dados&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;assets/fig/hadley_view.png&quot; style=&quot;width: 800px;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;as-cinco-funes-principais-do-dplyr&quot;&gt;As cinco funções principais do dplyr&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;filter&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;mutate&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;select&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;arrange&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;summarise&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;caractersticas&quot;&gt;Características&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;O &lt;em&gt;input&lt;/em&gt;  é sempre um &lt;code&gt;data.frame&lt;/code&gt; (&lt;code&gt;tbl&lt;/code&gt;), e o &lt;em&gt;output&lt;/em&gt;  é sempre um &lt;code&gt;data.frame&lt;/code&gt; (&lt;code&gt;tbl&lt;/code&gt;).&lt;/li&gt;
  &lt;li&gt;No primeiro argumento colocamos o &lt;code&gt;data.frame&lt;/code&gt;, e nos outros argumentos colocamo o que queremos fazer.&lt;/li&gt;
  &lt;li&gt;A utilização é facilitada com o emprego do operador &lt;code&gt;%&amp;gt;%&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;vantagens&quot;&gt;Vantagens&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;Utiliza &lt;code&gt;C&lt;/code&gt; e &lt;code&gt;C++&lt;/code&gt; por trás da maioria das funções, o que geralmente torna o código mais eficiente.&lt;/li&gt;
  &lt;li&gt;Pode trabalhar com diferentes fontes de dados, como bases relacionais (SQL) e &lt;code&gt;data.table&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;select&quot;&gt;select&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Utilizar &lt;code&gt;starts_with(x)&lt;/code&gt;, &lt;code&gt;contains(x)&lt;/code&gt;, &lt;code&gt;matches(x)&lt;/code&gt;, &lt;code&gt;one_of(x)&lt;/code&gt;, etc.&lt;/li&gt;
  &lt;li&gt;Possível colocar nomes, índices, e intervalos de variáveis com &lt;code&gt;:&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# por indice (nao recomendavel!)&lt;/span&gt;
pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# especificando nomes (maneira mais usual)&lt;/span&gt;
pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# intervalos e funcoes auxiliares (para economizar trabalho)&lt;/span&gt;
pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; starts_with&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;idhm&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;filter&quot;&gt;filter&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Parecido com &lt;code&gt;subset&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Condições separadas por vírgulas é o mesmo que separar por &lt;code&gt;&amp;amp;&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# somente estado de SP, com IDH municipal maior que 80% no ano 2010&lt;/span&gt;
pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ufn&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;São Paulo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;.8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# mesma coisa que o anterior&lt;/span&gt;
pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ufn&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;São Paulo&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; idhm &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;.8&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# !is.na(x)&lt;/span&gt;
pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; PEA&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;is.na&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;PEA&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# %in%&lt;/span&gt;
pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;municipio &lt;span class=&quot;o&quot;&gt;%in%&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;CAMPINAS&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;SÃO PAULO&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;mutate&quot;&gt;mutate&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Parecido com &lt;code&gt;transform&lt;/code&gt;, mas aceita várias novas colunas iterativamente.&lt;/li&gt;
  &lt;li&gt;Novas variáveis devem ter o mesmo &lt;code&gt;length&lt;/code&gt; que o &lt;code&gt;nrow&lt;/code&gt; do bd oridinal ou &lt;code&gt;1&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm_porc &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; idhm &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         idhm_porc_txt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;paste&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm_porc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# media de idhm_l e idhm_e&lt;/span&gt;
pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; starts_with&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;idhm&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm2 &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm_e &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; idhm_l&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;c1&quot;&gt;## errado&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# pnud_muni %&amp;gt;%&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#   select(ano, ufn, municipio, starts_with(&amp;#39;idhm&amp;#39;)) %&amp;gt;%&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#   filter(ano==2010) %&amp;gt;%&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#   mutate(idhm2 = mean(c(idhm_e, idhm_l)))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;## uma alternativa (+ demorada)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# pnud_muni %&amp;gt;%&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#   select(ano, ufn, municipio, starts_with(&amp;#39;idhm&amp;#39;)) %&amp;gt;%&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#   filter(ano==2010) %&amp;gt;%&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#   rowwise() %&amp;gt;%&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#   mutate(idhm2 = mean(c(idhm_e, idhm_l)))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;arrange&quot;&gt;arrange&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Simplesmente ordena de acordo com as opções.&lt;/li&gt;
  &lt;li&gt;Utilizar &lt;code&gt;desc&lt;/code&gt; para ordem decrescente.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm_porc &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; idhm &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         idhm_porc_txt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;paste&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm_porc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  arrange&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idhm&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  mutate&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm_porc &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; idhm &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;m&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
         idhm_porc_txt &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kp&quot;&gt;paste&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm_porc&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&amp;#39;%&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  arrange&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;desc&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;summarise&quot;&gt;summarise&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Retorna um vetor de tamanho &lt;code&gt;1&lt;/code&gt; a partir de uma conta com as variáveis.&lt;/li&gt;
  &lt;li&gt;Geralmente é utilizado em conjunto com &lt;code&gt;group_by&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Algumas funções importantes: &lt;code&gt;n()&lt;/code&gt;, &lt;code&gt;n_distinct()&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;  
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ufn&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  summarise&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;n&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
            idhm_medio&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            populacao_total&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;popt&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  arrange&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;desc&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;idhm_medio&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;  
  count&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ufn&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  tally&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  head &lt;span class=&quot;c1&quot;&gt;# nao precisa de parenteses!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;data-tidying-com-tidyr&quot;&gt;Data Tidying com tidyr&lt;/h2&gt;

&lt;h3 id=&quot;sobre-tidy-data&quot;&gt;Sobre tidy data&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Cada observação é uma linha do bd.&lt;/li&gt;
  &lt;li&gt;Cada variável é uma coluna do bd.&lt;/li&gt;
  &lt;li&gt;Para cada unidade observacional temos um bd separado (possivelmente com chaves de associacao).&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;spread&quot;&gt;spread&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;“Joga” uma variável nas colunas&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  group_by&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; ufn&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  summarise&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;populacao&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;popt&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  ungroup&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  spread&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; populacao&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;gather&quot;&gt;gather&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;“Empilha” o banco de dados&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;pnud_muni &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  filter&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ano&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2010&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  select&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;ufn&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; municipio&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; starts_with&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;idhm_&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&amp;gt;%&lt;/span&gt;
  gather&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;tipo_idh&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; idh&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; starts_with&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;idhm_&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;## Error in eval(expr, envir, enclos): objeto &amp;#39;pnud_muni&amp;#39; não encontrado&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id=&quot;funes-auxiliares&quot;&gt;Funções auxiliares&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;unite&lt;/code&gt; junta duas ou mais colunas usando algum separador (&lt;code&gt;_&lt;/code&gt;, por exemplo).&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;separate&lt;/code&gt; faz o inverso de &lt;code&gt;unite&lt;/code&gt;, e uma coluna em várias usando um separador.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;um-pouco-mais-de-manipulao-de-dados&quot;&gt;Um pouco mais de manipulação de dados&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Para juntar tabelas, usar &lt;code&gt;inner_join&lt;/code&gt;, &lt;code&gt;left_join&lt;/code&gt;, &lt;code&gt;anti_join&lt;/code&gt;, etc.&lt;/li&gt;
  &lt;li&gt;Para realizar operações mais gerais, usar &lt;code&gt;do&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Para retirar duplicatas, utilizar &lt;code&gt;distinct&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;outros-pacotes-teis-para-limpar-bases-de-dados&quot;&gt;Outros pacotes úteis para limpar bases de dados&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code&gt;stringr&lt;/code&gt; para trabalhar com textos.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;lubridate&lt;/code&gt; para trabalhar com datas.&lt;/li&gt;
  &lt;li&gt;&lt;code&gt;rvest&lt;/code&gt; para trabalhar com arquivos HTML.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&amp;lt;hr/ &amp;gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 26 Jan 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula04/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula04/</guid>
        
        
      </item>
    
      <item>
        <title>Aula 03 - Laboratório I</title>
        <description>&lt;h2 id=&quot;relatrios-dinmicos-com-rmarkdown&quot;&gt;Relatórios dinâmicos com RMarkdown&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Utilização da linguagem de marcação &lt;em&gt;markdown&lt;/em&gt;.&lt;/li&gt;
  &lt;li&gt;Possibilidade de incluir código R nos arquivos.&lt;/li&gt;
  &lt;li&gt;Roda com o pacote &lt;code&gt;knitr&lt;/code&gt; e o programa &lt;code&gt;pandoc&lt;/code&gt;.&lt;/li&gt;
  &lt;li&gt;Possibilidade de criar relatórios em html, docx, pdf, latex, entre outros.&lt;/li&gt;
  &lt;li&gt;Possibilidade de criar apresentações e relatórios com gráficos dinãmicos.&lt;/li&gt;
  &lt;li&gt;Possibilidade de inserir sintaxe matemática, como $e^{i\pi}=-1$, nos documentos.&lt;/li&gt;
  &lt;li&gt;Documentos interativos com o &lt;code&gt;shiny&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;como-utilizar&quot;&gt;Como utilizar&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;Mais fácil com RStudio.&lt;/li&gt;
  &lt;li&gt;Conceitos básicos de Markdown &lt;a href=&quot;http://daringfireball.net/projects/markdown/&quot;&gt;nesse link&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;RMarkdown com exemplos &lt;a href=&quot;http://rmarkdown.rstudio.com/&quot;&gt;nesse link&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;Sobre os metadados em YAML &lt;a href=&quot;http://rmarkdown.rstudio.com/html_document_format.html&quot;&gt;nesse link&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;exemplo-cdigo-que-gerou-a-aula-01httpsgithubcomcurso-rcurso-rgithubcomblobmasterpostsaula01rmd&quot;&gt;Exemplo: &lt;a href=&quot;https://github.com/curso-r/curso-r.github.com/blob/master/posts/aula01.Rmd&quot;&gt;código que gerou a aula 01&lt;/a&gt;.&lt;/h4&gt;

&lt;h2 id=&quot;exerccio-do-laboratrio&quot;&gt;Exercício do Laboratório&lt;/h2&gt;

&lt;p&gt;A base de dados &lt;a href=&quot;http://curso-r.github.io/assets/data/pnud.xlsx&quot;&gt;pnud.xlsx&lt;/a&gt; foi construida pelo Programa das Nações Unidas para o Desenvolvimento e contém informações demográficas e socioeconômicas de cada município brasileiro nos anos de 1991, 2000 e 2010. Essas informações são baseadas nos censos e são utilizadas para o cálculo do IDH municipal. A base
original pode ser baixada &lt;a href=&quot;http://www.atlasbrasil.org.br/2013/pt/download/&quot;&gt;neste link&lt;/a&gt;. A &lt;a href=&quot;http://curso-r.github.io/assets/data/pnud.xlsx&quot;&gt;versão utilizada no laboratório&lt;/a&gt; foi ligeiramente modificada para facilitar algumas atividades.&lt;/p&gt;

&lt;h3 id=&quot;downloadhttpcurso-rgithubioassetsdatapnudxlsx&quot;&gt;&lt;a href=&quot;http://curso-r.github.io/assets/data/pnud.xlsx&quot;&gt;Download&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;O arquivo contém 4 planilhas. Vamos utilizar a planilha &lt;em&gt;siglas&lt;/em&gt;, que contém a definição das variáveis,
e a planilha &lt;em&gt;mun&lt;/em&gt;, que contém as informações demográficas e socioeconômicas por município 
brasileiro.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Queremos que vocês descubram&lt;/strong&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Quais são os seis municípios com os maiores IDH municipais em 2010.&lt;/li&gt;
  &lt;li&gt;Qual é a unidade federativa com menor expectativa de vida média, ponderada pela população dos municípios em 2000.&lt;/li&gt;
  &lt;li&gt;Quais são os municípios &lt;em&gt;outliers&lt;/em&gt; com relação ao índice de Gini em 1991 e em 2010.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Outras atividades&lt;/strong&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Monte um gráfico que mostre no eixo &lt;code&gt;x&lt;/code&gt; a quantidade de municípios (em forma de porcentagem) e no eixo &lt;code&gt;y&lt;/code&gt; a população acumulada desses municípios. Ordene os dados de forma apropriada para responder a pergunta: 20% dos municípios concentram quantos % da população? E os 30%? E x% (crie uma função)?&lt;/li&gt;
  &lt;li&gt;Categorize a renda per capita e associe com a expectativa de vida.&lt;/li&gt;
  &lt;li&gt;Você acha que a situação do Brasil está melhorando? Justifique utlizando dados de pelo menos 3 variáveis.&lt;/li&gt;
  &lt;li&gt;No nordeste o aumento de distribuição de renda foi maior do que no sudeste?&lt;/li&gt;
  &lt;li&gt;Insira mais pelo menos 3 estudos que você ache interessante.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;relatrio&quot;&gt;Relatório&lt;/h2&gt;

&lt;p&gt;Elabore um relatório utilizando RMarkdown com uma análise descritiva da base de dados do PNUD, 
descrevendo as variáveis utilizadas e executando as atividades pedidas.&lt;/p&gt;
</description>
        <pubDate>Fri, 23 Jan 2015 00:00:00 +0100</pubDate>
        <link>http://curso-r.github.io/versao2016//aula03/</link>
        <guid isPermaLink="true">http://curso-r.github.io/versao2016//aula03/</guid>
        
        
      </item>
    
  </channel>
</rss>
